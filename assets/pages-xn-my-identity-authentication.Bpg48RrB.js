import{_ as a,K as e,L as t,r as s,au as l,d as o,x as n,y as c,b as i,f as r,J as f,z as u,m as d,o as p,j as m,u as _,k as g,a1 as k,g as x,F as y,a4 as b,D as C,a5 as h,P as F,E as v,p as w,a2 as j}from"./index-E36eYFUz.js";import{_ as z}from"./Navigation.fXnM5b3z.js";import{_ as D}from"./CxComfirmBtn.D_Y-qTM9.js";import{p as A,q as I}from"./xn.B6pvNNd_.js";const L=a({__name:"identity-authentication",setup(a){e((a=>({"4127ebf0":N})));const{proxy:L}=f(),N=L.$safeAreaInfo.top+80+"rpx",P=t();let q=s("身份认证"),B=s(!1),E=s(!0);const J=L.getOpenerEventChannel();let K=l({front:"",back:""});const O=a=>{j({urls:[a]})},T=a=>{console.log("点击上传"+("front"===a?"正面":"反面")),b({count:1,success:e=>{console.log("选择图片成功:",e.tempFilePaths[0]),K[a]=e.tempFilePaths[0]}})},U=async()=>{if(K.front&&K.back){B.value=!0;try{const a=await h(K.front),e=await h(K.back),t=await I({front_image:a.data.url||"",back_image:e.data.url||""}),{code:s=9999,data:l,msg:o}=t;200===s?(C({title:"上传成功，等待审核",icon:"success"}),P.updateUserInfo("XN",{real_name_check:1}),setTimeout((()=>{F({url:"/pages/index"})}),1500)):C({title:o||"上传失败，请重试",icon:"none"})}catch(a){console.error("认证失败",a),C({title:"string"==typeof a?a:a.msg||"上传请求异常",icon:"none"})}finally{B.value=!1}}else C({title:"请上传身份证正反面",icon:"none"})};return o((async()=>{J.on("acceptLevelData",(a=>{console.log("接收到的数据：",a)})),await A()})),(a,e)=>{const t=n(c("LayoutNavigation"),z),s=v,l=w,o=n(c("u-icon"),u),f=d,b=n(c("CxComfirmBtn"),D);return p(),i(f,{class:"page-wrap index"},{default:r((()=>[m(t,{title:_(q)},{right:r((()=>[])),_:1},8,["title"]),_(E)?(p(),i(f,{key:0,class:"page-content"},{default:r((()=>[m(f,{class:"container"},{default:r((()=>[m(f,{class:"background-pattern"},{default:r((()=>[m(f,{class:"content-box"},{default:r((()=>[m(f,{class:"upload-item"},{default:r((()=>[m(s,{class:"label"},{default:r((()=>[g("身份证正面")])),_:1}),m(f,{class:"upload-area",onClick:e[1]||(e[1]=a=>T("front"))},{default:r((()=>[_(K).front?(p(),i(l,{key:0,src:_(K).front,class:"preview-img",mode:"widthFix",onClick:e[0]||(e[0]=k((a=>O(_(K).front)),["stop"]))},null,8,["src"])):(p(),x(y,{key:1},[m(o,{name:"plus",color:"#FF4D4D",size:"60"}),m(s,{class:"tip"},{default:r((()=>[g("点击上传")])),_:1})],64))])),_:1})])),_:1}),m(f,{class:"upload-item"},{default:r((()=>[m(s,{class:"label"},{default:r((()=>[g("身份证反面")])),_:1}),m(f,{class:"upload-area",onClick:e[3]||(e[3]=a=>T("back"))},{default:r((()=>[_(K).back?(p(),i(l,{key:0,src:_(K).back,class:"preview-img",mode:"widthFix",onClick:e[2]||(e[2]=k((a=>O(_(K).back)),["stop"]))},null,8,["src"])):(p(),x(y,{key:1},[m(o,{name:"plus",color:"#FF4D4D",size:"60"}),m(s,{class:"tip"},{default:r((()=>[g("点击上传")])),_:1})],64))])),_:1})])),_:1})])),_:1})])),_:1}),m(f,{class:"submit-btn"},{default:r((()=>[m(b,{text:"开始上传",loading:_(B),onClick:U},null,8,["loading"])])),_:1})])),_:1})])),_:1})):(p(),i(f,{key:1,class:"page-content"},{default:r((()=>[m(f,{class:"container"},{default:r((()=>[m(f,{style:{display:"flex","justify-content":"center","align-items":"center"}},{default:r((()=>[m(o,{name:"checkmark-circle",color:"#4CAF50",size:"50"}),m(f,{style:{"font-size":"32rpx",color:"#fff"}},{default:r((()=>[g("   您已提交身份认证申请")])),_:1})])),_:1}),m(f,{style:{"font-size":"28rpx",color:"#666","margin-top":"10rpx","text-align":"center"}},{default:r((()=>[g("请耐心等待审核结果")])),_:1})])),_:1})])),_:1})),m(f)])),_:1})}}},[["__scopeId","data-v-fc9802f9"]]);export{L as default};

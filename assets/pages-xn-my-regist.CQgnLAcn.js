import{_ as e,R as o,r as a,ag as t,C as s,D as l,b as n,f as r,Q as c,a0 as i,aE as d,m as p,E as u,o as m,j as f,u as x,l as h,n as g,k as w,t as y,aF as _,J as v,W as z,aG as N,p as V,A as P}from"./index-DiJpDbC3.js";import{_ as b}from"./Navigation.CPbYaFbJ.js";import{_ as k}from"./CxComfirmBtn.CPDBkoVY.js";import{_ as C}from"./zhanghao.BgAr4qWD.js";import{_ as j,a as F}from"./emiyanzhengma.C1RAKEWA.js";import{_ as $}from"./mima.CnEZst9Z.js";const A=e({__name:"regist",setup(e){o((e=>({13242905:U})));const{proxy:A}=c(),U=A.$safeAreaInfo.top+80+"rpx";let I=a("注册用户"),Z=a(!1);const B=t({accoutName:"",phone:"",code:"",password:"",confirmPassword:""}),E=t({accoutName:"",phone:"",code:"",password:"",confirmPassword:""}),T=e=>{E[e]="",Z.value=!1},W=async()=>{if((()=>{var e;let o=!0;const a=null==(e=B.accoutName)?void 0:e.trim();a?a.length<6||a.length>20?(E.accoutName="账户名字母开头6-20位",o=!1):/^[a-zA-Z][a-zA-Z0-9]*$/.test(a)||(E.accoutName="字母开头且仅包含字母数字",o=!1):(E.accoutName="用户名不能为空",o=!1),B.phone?/^1[3-9]\d{9}$/.test(B.phone)||(E.phone="手机号格式不正确",o=!1):(E.phone="手机号不能为空",o=!1),B.code?6!==B.code.length&&(E.code="验证码格式不正确",o=!1):(E.code="验证码不能为空",o=!1);const t=B.password;return t?t.length<6||t.length>20?(E.password="密码长度6-20位",o=!1):/^[A-Za-z]/.test(t)||(E.password="密码必须字母开头",o=!1):(E.password="密码不能为空",o=!1),B.confirmPassword?B.confirmPassword!==t&&(E.confirmPassword="两次输入的密码不一致",o=!1):(E.confirmPassword="请再次输入密码",o=!1),o})()){Z.value=!0;try{const e=await _({username:B.accoutName,password:B.password,phone:B.phone,sms_code:B.code,confirm_password:B.confirmPassword});200===e.code?(v({title:"注册成功！",icon:"success"}),setTimeout((()=>{z({url:"/pages/login?role=XN"})}),1500)):v({title:e.msg||"注册失败",icon:"none"})}catch(e){console.error("注册失败",e),v({title:e.msg||"注册失败",icon:"none"})}finally{Z.value=!1}}},D=a(!1),G=a(!1),J=a(!1),L=a(60),Q=async()=>{if(!J.value)if(B.phone)if(/^1[3-9]\d{9}$/.test(B.phone))try{const e=await N({phone:B.phone,type:1});if(200===e.code){v({title:"验证码已发送",icon:"success"}),J.value=!0,B.code=e.data.sms_code;const o=setInterval((()=>{L.value--,L.value<=0&&(clearInterval(o),J.value=!1,L.value=60)}),1e3)}else v({title:e.msg||"发送失败",icon:"none"})}catch(e){console.error("发送验证码失败",e),v({title:e.msg||"发送失败",icon:"none"})}else E.phone="请输入正确的手机号";else E.phone="请输入手机号"},R=()=>{D.value=!D.value},S=()=>{G.value=!G.value};return(e,o)=>{const a=s(l("LayoutNavigation"),b),t=V,c=s(l("u-input"),i),_=s(l("u-text"),d),v=p,z=P,N=s(l("u-icon"),u),A=s(l("CxComfirmBtn"),k);return m(),n(v,{class:"page-wrap index"},{default:r((()=>[f(a,{title:x(I)},null,8,["title"]),f(v,{class:"page-content"},{default:r((()=>[f(v,{class:"container"},{default:r((()=>[f(v,{class:"input-item"},{default:r((()=>[f(t,{class:"input-icon",src:C,mode:"aspectFit"}),f(c,{modelValue:x(B).accoutName,"onUpdate:modelValue":[o[0]||(o[0]=e=>x(B).accoutName=e),o[1]||(o[1]=e=>T("accoutName"))],placeholder:"账户名字母开头6-20非中文字符",type:"text",border:"none",maxlength:"11","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue"]),x(E).accoutName?(m(),n(_,{key:0,class:"error-text",text:x(E).accoutName,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):h("",!0)])),_:1}),f(v,{class:"input-item"},{default:r((()=>[f(t,{class:"input-icon",src:j,mode:"aspectFit"}),f(c,{modelValue:x(B).phone,"onUpdate:modelValue":[o[2]||(o[2]=e=>x(B).phone=e),o[3]||(o[3]=e=>T("phone"))],placeholder:"请输入您的手机号码",type:"number",border:"none",maxlength:"11","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue"]),x(E).phone?(m(),n(_,{key:0,class:"error-text",text:x(E).phone,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):h("",!0)])),_:1}),f(v,{class:"input-item"},{default:r((()=>[f(t,{class:"input-icon",src:F,mode:"aspectFit"}),f(c,{modelValue:x(B).code,"onUpdate:modelValue":[o[4]||(o[4]=e=>x(B).code=e),o[5]||(o[5]=e=>T("code"))],placeholder:"请输入验证码",type:"text",border:"none","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue"]),x(E).code?h("",!0):(m(),n(z,{key:0,onClick:Q,class:"verify-btn",style:g({color:x(J)?"#ccc":"#ff4d4d",fontWeight:"normal"})},{default:r((()=>[w(y(x(J)?`${x(L)}s后重试`:"获取验证码"),1)])),_:1},8,["style"])),x(E).code?(m(),n(_,{key:1,class:"error-text",text:x(E).code,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):h("",!0)])),_:1}),f(v,{class:"input-item"},{default:r((()=>[f(t,{class:"input-icon",src:$,mode:"aspectFit"}),f(c,{modelValue:x(B).password,"onUpdate:modelValue":[o[6]||(o[6]=e=>x(B).password=e),o[7]||(o[7]=e=>T("password"))],placeholder:"字母开头,必须包含特殊字符6-20位",type:x(D)?"text":"password",border:"none","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue","type"]),f(N,{name:x(D)?"eye":"",size:"36",color:"#999",onClick:R},null,8,["name"]),x(E).password?(m(),n(_,{key:0,class:"error-text",text:x(E).password,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):h("",!0)])),_:1}),f(v,{class:"input-item"},{default:r((()=>[f(t,{class:"input-icon",src:$,mode:"aspectFit"}),f(c,{modelValue:x(B).confirmPassword,"onUpdate:modelValue":[o[8]||(o[8]=e=>x(B).confirmPassword=e),o[9]||(o[9]=e=>T("confirmPassword"))],placeholder:"请再次输入密码",type:x(G)?"text":"password",border:"none","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue","type"]),f(N,{name:x(G)?"eye":"",size:"36",color:"#999",onClick:S},null,8,["name"]),x(E).confirmPassword?(m(),n(_,{key:0,class:"error-text",text:x(E).confirmPassword,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):h("",!0)])),_:1})])),_:1}),f(v,{class:"regist-btn-wrap"},{default:r((()=>[f(A,{text:"确认注册",loading:x(Z),onClick:W},null,8,["loading"])])),_:1})])),_:1}),f(v)])),_:1})}}},[["__scopeId","data-v-6b9ba0ce"]]);export{A as default};

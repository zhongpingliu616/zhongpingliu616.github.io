import{_ as a,Q as e,r as t,ad as s,d as l,aw as o,C as n,D as c,b as i,f as r,P as u,E as f,m as d,o as p,j as m,u as _,k as g,X as k,g as y,F as b,aq as x,J as C,an as F,ao as h,T as w,A as v,p as D,ap as j}from"./index-Cklw5-2D.js";import{_ as z}from"./Navigation.DJK0J8h_.js";import{_ as L}from"./CxComfirmBtn.C_6MRR7B.js";const B=a({__name:"identity-authentication",setup(a){const B=e();let N=t("身份认证"),P=t(!1),R=t(!0);const{proxy:U}=u(),A=U.getOpenerEventChannel();let E=s({front:"",back:""});const I=a=>{j({urls:[a]})},Q=a=>{console.log("点击上传"+("front"===a?"正面":"反面")),x({count:1,success:e=>{console.log("选择图片成功:",e.tempFilePaths[0]),E[a]=e.tempFilePaths[0]}})},T=async()=>{if(E.front&&E.back){P.value=!0;try{const a=await F(E.front),e=await F(E.back);console.log("Front URL:",a),console.log("Back URL:",e);const t=await h({front_image:a.url,back_image:e.url}),{code:s=9999,data:l,msg:o}=t;200===s?(C({title:"上传成功，等待审核",icon:"success"}),B.updateUserInfo("XN",{real_name_check:1}),setTimeout((()=>{w({url:"/pages/index"})}),1500)):C({title:o||"上传失败，请重试",icon:"none"})}catch(a){console.error("认证失败",a),C({title:"string"==typeof a?a:a.msg||"上传请求异常",icon:"none"})}finally{P.value=!1}}else C({title:"请上传身份证正反面",icon:"none"})};return l((async()=>{A.on("acceptLevelData",(a=>{console.log("接收到的数据：",a)})),await o()})),(a,e)=>{const t=n(c("LayoutNavigation"),z),s=v,l=D,o=n(c("u-icon"),f),u=d,x=n(c("CxComfirmBtn"),L);return p(),i(u,{class:"page-wrap index"},{default:r((()=>[m(t,{title:_(N)},{right:r((()=>[])),_:1},8,["title"]),_(R)?(p(),i(u,{key:0,class:"page-content"},{default:r((()=>[m(u,{class:"container"},{default:r((()=>[m(u,{class:"background-pattern"},{default:r((()=>[m(u,{class:"content-box"},{default:r((()=>[m(u,{class:"upload-item"},{default:r((()=>[m(s,{class:"label"},{default:r((()=>[g("身份证正面")])),_:1}),m(u,{class:"upload-area",onClick:e[1]||(e[1]=a=>Q("front"))},{default:r((()=>[_(E).front?(p(),i(l,{key:0,src:_(E).front,class:"preview-img",mode:"widthFix",onClick:e[0]||(e[0]=k((a=>I(_(E).front)),["stop"]))},null,8,["src"])):(p(),y(b,{key:1},[m(o,{name:"plus",color:"#FF4D4D",size:"60"}),m(s,{class:"tip"},{default:r((()=>[g("点击上传")])),_:1})],64))])),_:1})])),_:1}),m(u,{class:"upload-item"},{default:r((()=>[m(s,{class:"label"},{default:r((()=>[g("身份证反面")])),_:1}),m(u,{class:"upload-area",onClick:e[3]||(e[3]=a=>Q("back"))},{default:r((()=>[_(E).back?(p(),i(l,{key:0,src:_(E).back,class:"preview-img",mode:"widthFix",onClick:e[2]||(e[2]=k((a=>I(_(E).back)),["stop"]))},null,8,["src"])):(p(),y(b,{key:1},[m(o,{name:"plus",color:"#FF4D4D",size:"60"}),m(s,{class:"tip"},{default:r((()=>[g("点击上传")])),_:1})],64))])),_:1})])),_:1})])),_:1})])),_:1}),m(u,{class:"submit-btn"},{default:r((()=>[m(x,{text:"开始上传",loading:_(P),onClick:T},null,8,["loading"])])),_:1})])),_:1})])),_:1})):(p(),i(u,{key:1,class:"page-content"},{default:r((()=>[m(u,{class:"container"},{default:r((()=>[m(u,{style:{display:"flex","justify-content":"center","align-items":"center"}},{default:r((()=>[m(o,{name:"checkmark-circle",color:"#4CAF50",size:"50"}),m(u,{style:{"font-size":"32rpx",color:"#fff"}},{default:r((()=>[g("   您已提交身份认证申请")])),_:1})])),_:1}),m(u,{style:{"font-size":"28rpx",color:"#666","margin-top":"10rpx","text-align":"center"}},{default:r((()=>[g("请耐心等待审核结果")])),_:1})])),_:1})])),_:1})),m(u)])),_:1})}}},[["__scopeId","data-v-1f2619b8"]]);export{B as default};

import{_ as a,Q as e,r as l,d as o,w as s,Y as r,v as t,a as n,C as u,D as c,b as d,f as i,P as p,M as m,N as f,J as v,m as _,o as g,j as h,k as C,u as x,H as b,g as w,h as y,F as j,A as T,I}from"./index-bLIxdInw.js";import{_ as O}from"./OrderCard.CueXoE-p.js";import{_ as L}from"./ProductList.Dgs-2H1c.js";import{_ as S}from"./CustomBarXn.CtjDdMGZ.js";import"./CxTag.Ubg2F8Fn.js";import"./CxComfirmBtn.BhasumNO.js";const k=a({__name:"index",setup(a){e((a=>({"4820bcba":B})));const{proxy:k}=p(),B=k.$safeAreaInfo.top+24+"rpx";l("orders");let P=l("");const R=function(a,e=1500){let l=null;const o=()=>{l&&clearTimeout(l),l=setTimeout(a,e)};return o.cancel=()=>{l&&(clearTimeout(l),l=null)},o}((()=>{M(!0)}),1600);l(3);const A=l([]),F=l(!1),H=l(!1),V=l(1),X=l(10),$=l(!1),G=l("loadmore"),J=l("flower"),M=async(a=!1)=>{if((!F.value||a)&&(!H.value||a)&&(!$.value||a)){a?(V.value=1,$.value=!1,H.value=!0,G.value="loading"):(F.value=!0,G.value="loading");try{const e=await m({page_no:V.value,page_size:X.value,keyword:P.value}),l=200===e.code&&e.data.lists||[];l.length<X.value?($.value=!0,G.value="nomore"):G.value="loadmore",a?(A.value=l,f()):A.value=[...A.value,...l],V.value++}catch(e){G.value="loadmore",console.error("数据加载失败:",e),v({title:"加载失败",icon:"none"})}finally{F.value=!1,H.value=!1}}},Q=()=>{H.value||M(!0)},z=()=>{F.value||$.value||M()},D=a=>{I({url:`/pages/xn/collection-detail/index?id=${a.id}`})},E=a=>{console.log(a),a.canGrab,I({url:`/pages/xn/my/deposit?id=${a.id}`})};o((()=>{M(!0)})),s(P,(a=>{R()}));const N=()=>{R()};return r((()=>{R&&R.cancel&&R.cancel()})),t((()=>{})),(a,e)=>{const l=_,o=T,s=n("up-col"),r=n("up-search"),t=n("up-row"),p=u(c("XnOrdersOrderCard"),O),m=u(c("BaseProductList"),L),f=u(c("LayoutCustomBarXn"),S);return g(),d(l,{class:"page-wrap orders"},{default:i((()=>[h(l),h(l,{class:"page-content"},{default:i((()=>[h(l,{class:"order-search"},{default:i((()=>[h(t,{customStyle:"margin-bottom: 10px"},{default:i((()=>[h(s,{span:"2"},{default:i((()=>[h(l,{class:"order-text-wrap"},{default:i((()=>[h(o,{class:"order-text"},{default:i((()=>[C("订单")])),_:1})])),_:1})])),_:1}),h(s,{span:"9"},{default:i((()=>[h(l,{class:"search-bar"},{default:i((()=>[h(r,{modelValue:x(P),"onUpdate:modelValue":e[0]||(e[0]=a=>b(P)?P.value=a:P=a),placeholder:"输入搜索内容",bgColor:"#fff",placeholderColor:"#AC9394",searchIconColor:"#672227",borderColor:"#FFE185",height:"66rpx",onSearch:N,"show-action":!1,clearabled:""},null,8,["modelValue"])])),_:1})])),_:1}),h(s,{span:"1"})])),_:1})])),_:1}),h(l,{class:"order-list"},{default:i((()=>[h(l,{class:"order-container"},{default:i((()=>[h(m,{onOnScrollToLower:z,onOnRefresh:Q,isRefreshing:x(H),loadStatus:x(G),iconType:x(J),enableRefresh:!0,enableLoadMore:!0,class:"scroll-view"},{scrollContain:i((()=>[(g(!0),w(j,null,y(x(A),((a,e)=>(g(),d(p,{item:a,onGrabOrderClick:E,onHandleItemClick:D},null,8,["item"])))),256))])),_:1},8,["isRefreshing","loadStatus","iconType"])])),_:1})])),_:1})])),_:1}),h(f)])),_:1})}}},[["__scopeId","data-v-430645a6"]]);export{k as default};

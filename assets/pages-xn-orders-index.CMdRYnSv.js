import{_ as a,Q as e,r as l,d as o,w as s,Y as r,v as t,a as n,C as u,D as c,b as d,f as i,P as p,M as m,N as f,J as v,m as _,o as g,j as h,k as C,u as x,H as b,g as w,h as y,F as j,A as T,I as L}from"./index-CFeN5XM9.js";import{_ as O}from"./OrderCard.BBIxj0vn.js";import{_ as S}from"./ProductList.X_LjGJfO.js";import{_ as I}from"./CustomBarXn.BcoS0-Sj.js";import"./CxTag.c9OneOu4.js";import"./CxComfirmBtn.BA1OBJ6W.js";const R=a({__name:"index",setup(a){e((a=>({"4820bcba":k})));const{proxy:R}=p(),k=R.$safeAreaInfo.top+24+"rpx";l("orders");let B=l("");const A=function(a,e=1500){let l=null;const o=()=>{l&&clearTimeout(l),l=setTimeout(a,e)};return o.cancel=()=>{l&&(clearTimeout(l),l=null)},o}((()=>{M(!0)}),1600);l(3);const F=l([]),P=l(!1),V=l(!1),X=l(1),$=l(10),G=l(!1),H=l("loadmore"),J=l("flower"),M=async(a=!1)=>{if((!P.value||a)&&(!V.value||a)&&(!G.value||a)){a?(X.value=1,G.value=!1,V.value=!0,H.value="loading"):(P.value=!0,H.value="loading");try{const e=await m({page_no:X.value,page_size:$.value,keyword:B.value}),l=200===e.code&&e.data.lists||[];l.length<$.value?(G.value=!0,H.value="nomore"):H.value="loadmore",a?(F.value=l,f()):F.value=[...F.value,...l],X.value++}catch(e){H.value="loadmore",console.error("数据加载失败:",e),v({title:"加载失败",icon:"none"})}finally{P.value=!1,V.value=!1}}},z=()=>{V.value||M(!0)},D=()=>{P.value||G.value||M()},E=a=>{L({url:`/pages/xn/collection-detail/index?id=${a.id}`})},K=a=>{console.log(a),a.canGrab,L({url:`/pages/xn/my/deposit?id=${a.id}`})};o((()=>{M(!0)})),s(B,(a=>{A()}));const N=()=>{A()};return r((()=>{A&&A.cancel&&A.cancel()})),t((()=>{})),(a,e)=>{const l=_,o=T,s=n("up-col"),r=n("up-search"),t=n("up-row"),p=u(c("XnOrdersOrderCard"),O),m=u(c("BaseProductList"),S),f=u(c("LayoutCustomBarXn"),I);return g(),d(l,{class:"page-wrap orders"},{default:i((()=>[h(l),h(l,{class:"page-content"},{default:i((()=>[h(l,{class:"order-search"},{default:i((()=>[h(t,{customStyle:"margin-bottom: 10px"},{default:i((()=>[h(s,{span:"2"},{default:i((()=>[h(l,{class:"order-text-wrap"},{default:i((()=>[h(o,{class:"order-text"},{default:i((()=>[C("订单")])),_:1})])),_:1})])),_:1}),h(s,{span:"9"},{default:i((()=>[h(l,{class:"search-bar"},{default:i((()=>[h(r,{modelValue:x(B),"onUpdate:modelValue":e[0]||(e[0]=a=>b(B)?B.value=a:B=a),placeholder:"输入搜索内容",bgColor:"#fff",placeholderColor:"#AC9394",searchIconColor:"#672227",borderColor:"#FFE185",height:"66rpx",onSearch:N,"show-action":!1,clearabled:""},null,8,["modelValue"])])),_:1})])),_:1}),h(s,{span:"1"})])),_:1})])),_:1}),h(l,{class:"order-list"},{default:i((()=>[h(l,{class:"order-container"},{default:i((()=>[h(m,{onOnScrollToLower:D,onOnRefresh:z,isRefreshing:x(V),loadStatus:x(H),iconType:x(J),enableRefresh:!0,enableLoadMore:!0,class:"scroll-view"},{scrollContain:i((()=>[(g(!0),w(j,null,y(x(F),((a,e)=>(g(),d(p,{item:a,onGrabOrderClick:K,onHandleItemClick:E},null,8,["item"])))),256))])),_:1},8,["isRefreshing","loadStatus","iconType"])])),_:1})])),_:1})])),_:1}),h(f)])),_:1})}}},[["__scopeId","data-v-430645a6"]]);export{R as default};

import{_ as a,r as e,c as t,ai as s,x as l,y as r,g as o,j as n,f as c,u as d,B as u,F as i,J as f,D as _,C as p,z as m,m as v,o as x,b,k as g,t as y,l as w,h as k,H as C,aq as h,E as F,p as j}from"./index-E36eYFUz.js";import{_ as D}from"./CxIconFont.D1tnD14h.js";import{_ as I}from"./Navigation.fXnM5b3z.js";import{_ as S}from"./uni-icons.DKvk8G6K.js";import{_ as z}from"./CxTag.DU_-stGW.js";import{_ as A}from"./CxComfirmBtn.D_Y-qTM9.js";import{_ as N}from"./CxModal.B62FgOA2.js";import{i as O,e as G,c as M}from"./xn.B6pvNNd_.js";import{g as U}from"./public.3bS5zsGE.js";import"./town._mydTJVR.js";const B=a({__name:"detail",setup(a){const{proxy:B}=f(),E=e("订单详情"),q=e([]),T=e({});let $=e({}),H=e(!1),J=e(!1),L=e(!1),K=e(!1);e("");let P={};e({});let Q=e(!1);const R={10:{text:"待支付",color:"#FF4D4F"},20:{text:"待平台发货",color:"#FA8C16"},30:{text:"待接收材料",color:"#1890FF"},40:{text:"制作中",color:"#FA541C"},50:{text:"待接收成品",color:"#13C2C2"},60:{text:"待验收",color:"#722ED1"},70:{text:"验收成功",color:"#52C41A"},80:{text:"验收失败",color:"#A8071A"},90:{text:"取消订单",color:"#8C8C8C"}},V={10:{text:"待付款",color:"#FF4D4F"},20:{text:"待发货",color:"#FA8C16"},50:{text:"待收货",color:"#13C2C2"},70:{text:"已完成",color:"#52C41A"},90:{text:"已取消",color:"#8C8C8C"}},W=t((()=>{var a;return(null==(a=(Q.value?V:R)[T.value.status])?void 0:a.text)||"未知状态"})),X=()=>{C({url:"/pages/xn/orders/index"})},Y=()=>{C({url:"/pages/xn/income/index"})},Z=()=>{h()},aa=()=>{p({url:"/pages/my/customer-service"})},ea=()=>{p({url:"/pages-xn/orders/submit-product",success:a=>{a.eventChannel.emit("sendOrderDatas",{orderInfo:T.value})}})},ta=async()=>{const{code:a=9999,data:e,msg:t}=await O({order_id:$.value.order_id});200===a?e.lists&&(q.value=[e.lists],T.value=e.lists,T.value.address||(T.value.address={})):_({title:t||"数据加载失败",icon:"none"})},sa=async()=>{const{msg:a,data:e,code:t}=await G({id:T.value.id,order_id:T.value.order_id,status:40});200===t?(_({title:"已确认收到材料",icon:"none"}),J.value=!1,ta()):_({title:a||"操作失败",icon:"none"})},la=async()=>{p({url:"/pages-xn/orders/submit-product",success:a=>{a.eventChannel.emit("sendOrderDatas",{orderInfo:T.value})}})},ra=()=>{},oa=async()=>{const{code:a=9999,data:e,msg:t}=await G({id:T.value.id,order_id:T.value.order_id,status:90});200===a?(_({title:"取消订单成功",icon:"none"}),H.value=!1,ta()):_({title:t||"取消订单失败",icon:"none"})},na=({type:a,item:e})=>{switch(P=e||T.value,a){case"cancel":H.value=!0;break;case"pay":p({url:`/pages-xn/my/deposit?id=${P.id}&order_id=${P.order_id}`,success:a=>{a.eventChannel.emit("sendOrderDatas",{orderInfo:P})}});break;case"remind":(async a=>{const{msg:e,data:t,code:s}=await M({order_id:a.order_id});_(200===s?{title:"已提醒商家发货",icon:"none"}:{title:e||"操作失败",icon:"none"})})(P);break;case"logistics":_({title:"查看物流详情",icon:"none"});break;case"receivingMaterials":J.value=!0;break;case"delete":K.value=!0;break;case"produced":L.value=!0}};return s((a=>{B.getOpenerEventChannel().on("sendOrderDatas",(a=>{a&&a.orderInfo&&($.value=a.orderInfo||{},T.value=$.value,q.value=[$.value],"buyer"===a.source&&(Q.value=!0),ta())}))})),(a,e)=>{const t=l(r("CxIconFont"),D),s=l(r("LayoutNavigation"),I),f=l(r("uni-icons"),S),_=l(r("u-icon"),m),p=F,C=v,h=j,O=l(r("CxTag"),z),G=l(r("CxComfirmBtn"),A),M=l(r("CxModal"),N);return x(),o(i,null,[n(C,{class:"page-wrap order-detail"},{default:c((()=>[n(s,{title:d(E)},{right:c((()=>[n(t,{code:"",size:"38rpx",color:"#fff",onClick:aa})])),_:1},8,["title"]),d(T)?(x(),b(C,{key:0,class:"page-content"},{default:c((()=>[n(C,{class:"status-header"},{default:c((()=>[30==d(T).status||40==d(T).status?(x(),b(f,{key:0,"custom-prefix":"iconfont",type:"icon-xiaohuoche",size:"40rpx",color:"#ffffff"})):70==d(T).status?(x(),b(f,{key:1,"custom-prefix":"iconfont",type:"icon-leiji-yijiaofuxiangmushuliang",size:"40rpx",color:"#ffffff"})):(x(),b(_,{key:2,name:"hourglass",size:"50rpx",color:"#fff"})),g("    "),30===d(T).status&&d(T).round_no>0?(x(),b(p,{key:3,class:"status-text"},{default:c((()=>[g("已退回")])),_:1})):(x(),b(p,{key:4,class:"status-text"},{default:c((()=>[g(y(d(W)),1)])),_:1}))])),_:1}),d(T).remark||d(T).actual_amount>0?(x(),b(C,{key:0,class:"card remark-card"},{default:c((()=>[n(C,{class:"card-title-row"},{default:c((()=>[n(C,{class:"indicator"}),30===d(T).status&&d(T).round_no>0?(x(),b(p,{key:0,class:"title-text"},{default:c((()=>[g("退回原因")])),_:1})):w("",!0),40===d(T).status&&d(T).round_no>0?(x(),b(p,{key:1,class:"title-text"},{default:c((()=>[g("退回原因")])),_:1})):w("",!0),70===d(T).status?(x(),b(p,{key:2,class:"title-text"},{default:c((()=>[g("验收信息")])),_:1})):(x(),b(p,{key:3,class:"right-text"},{default:c((()=>[g("备注：")])),_:1}))])),_:1}),d(T).actual_amount>0?(x(),b(C,{key:0,class:"remark-content"},{default:c((()=>[g(" 本次验收金额为："),n(p,{type:"warning",class:"value",style:{"font-size":"24rpx",color:"#FF5500"}},{default:c((()=>[g(y(d(T).actual_amount||""),1)])),_:1}),g(" 金额已发放至你余额，请注意查收！ ")])),_:1})):(x(),b(C,{key:1,class:"remark-content"},{default:c((()=>[g(y(d(T).remark||""),1)])),_:1}))])),_:1})):w("",!0),d(T).finish_order_info?(x(),b(C,{key:1,class:"card"},{default:c((()=>[n(C,{class:"card-title-row"},{default:c((()=>[n(C,{class:"indicator"}),n(p,{class:"title-text"},{default:c((()=>[g("平台收货地址信息")])),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("联系人")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).finish_order_info)?void 0:a.contact_person)||""),1)]})),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("联系电话")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).finish_order_info)?void 0:a.contact_phone)||""),1)]})),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("收货地址")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).finish_order_info)?void 0:a.shipping_address)||""),1)]})),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("物流单号")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).finish_order_info)?void 0:a.tracking_number)||""),1)]})),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("物流公司")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).finish_order_info)?void 0:a.logistics_company)||"快递"),1)]})),_:1})])),_:1})])),_:1})):w("",!0),d(T).address_info?(x(),b(C,{key:2,class:"card address-card"},{default:c((()=>[n(C,{class:"address-row"},{default:c((()=>[n(_,{name:"map-fill",color:"#FF4D4F",size:"50rpx"}),n(p,{class:"name"},{default:c((()=>{var a;return[g(y((null==(a=d(T).address_info)?void 0:a.contact_person)||""),1)]})),_:1}),n(p,{class:"phone"},{default:c((()=>{var a;return[g(y((null==(a=d(T).address_info)?void 0:a.contact_phone)||""),1)]})),_:1})])),_:1}),n(C,{class:"address-detail"},{default:c((()=>{var a;return[g(y(d(U)(d(T).address_info.address))+" "+y((null==(a=d(T).address_info)?void 0:a.detail_address)||""),1)]})),_:1})])),_:1})):w("",!0),[30,40].includes(d(T).status)?(x(),b(C,{key:3,class:"card"},{default:c((()=>[n(C,{class:"card-title-row"},{default:c((()=>[n(C,{class:"indicator"}),n(p,{class:"title-text"},{default:c((()=>[g("物流信息")])),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("物流单号")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).material_order_info)?void 0:a.tracking_number)||""),1)]})),_:1})])),_:1}),n(C,{class:"info-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("物流公司")])),_:1}),n(p,{class:"value"},{default:c((()=>{var a;return[g(y((null==(a=d(T).material_order_info)?void 0:a.logistics_company)||"快递"),1)]})),_:1})])),_:1})])),_:1})):w("",!0),n(C,{class:"card order-info-card"},{default:c((()=>[n(C,{class:"card-title-row"},{default:c((()=>[n(C,{class:"indicator"}),n(p,{class:"title-text"},{default:c((()=>[g("订单信息")])),_:1})])),_:1}),(x(!0),o(i,null,k(d(q),((a,e)=>(x(),b(C,{class:"goods-item",key:e},{default:c((()=>[n(h,{src:a.image,class:"goods-img",mode:"aspectFill"},null,8,["src"]),n(C,{class:"goods-content"},{default:c((()=>[n(C,{class:"goods-title"},{default:c((()=>[g(y(a.name),1)])),_:2},1024),n(C,{class:"tags"},{default:c((()=>[n(O,{text:"工期30天",bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"],color:"#bfa15f"},null,8,["bgGradient"]),g("   "),n(O,{text:"锦初等级",bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"],color:"#999"},null,8,["bgGradient"])])),_:1}),n(C,{class:"price-row"},{default:c((()=>[n(p,{class:"price"},{default:c((()=>[g("¥"+y(a.reward_amount),1)])),_:2},1024),n(p,{class:"num"},{default:c((()=>[g("x1")])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),n(C,{class:"fee-section"},{default:c((()=>[n(C,{class:"fee-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("订单押金 (共"+y(d(q).length)+"件)",1)])),_:1}),n(p,{class:"value"},{default:c((()=>[g("¥ "+y(Number(d(T).deposit||0).toFixed(2)),1)])),_:1})])),_:1}),n(C,{class:"fee-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("运费")])),_:1}),n(p,{class:"value"},{default:c((()=>[g("¥ "+y(Number(d(T).shipping_fee||0).toFixed(2)),1)])),_:1})])),_:1}),n(C,{class:"fee-row total-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("订单总价")])),_:1}),n(p,{class:"value total-price"},{default:c((()=>[g("¥ "+y(Number(d(T).final_amount||0).toFixed(2)),1)])),_:1})])),_:1})])),_:1}),n(C,{class:"divider"}),n(C,{class:"meta-section"},{default:c((()=>[n(C,{class:"meta-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("订单号")])),_:1}),n(p,{class:"value"},{default:c((()=>[g(y(d(T).order_id),1)])),_:1})])),_:1}),n(C,{class:"meta-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("下单时间")])),_:1}),n(p,{class:"value"},{default:c((()=>[g(y(d(T).create_time||"2025-12-29 19:41:37"),1)])),_:1})])),_:1}),n(C,{class:"meta-row"},{default:c((()=>[n(p,{class:"label"},{default:c((()=>[g("支付状态")])),_:1}),n(p,{class:"value"},{default:c((()=>[g(y(d(T).status<20?"未支付":"已支付"),1)])),_:1})])),_:1})])),_:1})])),_:1}),n(C,{class:"card payment-card"},{default:c((()=>[n(C,{class:"card-title-row"},{default:c((()=>[n(C,{class:"indicator"}),n(p,{class:"title-text"},{default:c((()=>[g("付款方式")])),_:1}),n(p,{class:"right-text"},{default:c((()=>[g("账户余额")])),_:1})])),_:1})])),_:1}),n(C,{class:"card deposit-card"},{default:c((()=>[n(C,{class:"card-title-row"},{default:c((()=>[n(C,{class:"indicator"}),n(p,{class:"title-text"},{default:c((()=>[g("押金减免")])),_:1})])),_:1}),n(C,{class:"deposit-content"},{default:c((()=>[n(C,{class:"sub-title"},{default:c((()=>[g("寄存")])),_:1}),n(C,{class:"desc"},{default:c((()=>[g("寄存在平台，平台会将【收藏证书】发放给您，后续【凭收藏证书】或订单凭证可拿回藏品。")])),_:1})])),_:1})])),_:1})])),_:1})):w("",!0),d(T)?(x(),b(C,{key:1,class:"footer-btns"},{default:c((()=>[20===d(T).status?(x(),o(i,{key:0},[n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"看看其他",btnStyle:{background:"transparent",color:"rgb(255, 225, 133)"},onClick:X},null,8,["btnStyle"])])),_:1}),n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"取消抢单",onClick:e[0]||(e[0]=a=>na({type:"cancel",orderItemDetail:d(T)}))})])),_:1})],64)):30===d(T).status?(x(),o(i,{key:1},[n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"看看其他",btnStyle:{background:"transparent",color:"rgb(255, 225, 133)"},onClick:X},null,8,["btnStyle"])])),_:1}),n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"确认收货",onClick:e[1]||(e[1]=a=>na({type:"receivingMaterials",orderItemDetail:d(T)}))})])),_:1})],64)):40===d(T).status?(x(),o(i,{key:2},[n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"联系客服",btnStyle:{background:"transparent",color:"rgb(255, 225, 133)"},onClick:aa},null,8,["btnStyle"])])),_:1}),n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"提交成品",onClick:ea})])),_:1})],64)):70===d(T).status?(x(),o(i,{key:3},[n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"我的收益",btnStyle:{background:"transparent",color:"rgb(255, 225, 133)"},onClick:Y},null,8,["btnStyle"])])),_:1}),n(C,{class:"btn-wrapper"},{default:c((()=>[n(G,{text:"再做一单",onClick:X})])),_:1})],64)):(x(),b(C,{key:4,class:"btn-wrapper"},{default:c((()=>[n(G,{text:"返回",btnStyle:{background:"transparent",color:"rgb(255, 225, 133)"},onClick:Z},null,8,["btnStyle"])])),_:1}))])),_:1})):w("",!0)])),_:1}),n(M,{show:d(H),"onUpdate:show":e[2]||(e[2]=a=>u(H)?H.value=a:H=a),content:"取消订单后押金原路返回到您的账户，但'押金减免额度 '将无法退回",onConfirm:oa},null,8,["show"]),n(M,{show:d(J),"onUpdate:show":e[3]||(e[3]=a=>u(J)?J.value=a:J=a),content:"确定收到材料了吗",onConfirm:sa},null,8,["show"]),n(M,{show:d(L),"onUpdate:show":e[4]||(e[4]=a=>u(L)?L.value=a:L=a),content:"确认完成了吗？",onConfirm:la},null,8,["show"]),n(M,{show:d(K),"onUpdate:show":e[5]||(e[5]=a=>u(K)?K.value=a:K=a),content:"确定要删除订单吗？",onConfirm:ra},null,8,["show"])],64)}}},[["__scopeId","data-v-5fb0faed"]]);export{B as default};

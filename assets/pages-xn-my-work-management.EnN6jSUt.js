import{_ as e}from"./Navigation.fXnM5b3z.js";import{_ as t,r as a,d as l,x as s,y as o,a as r,aG as n,aH as i,o as c,b as d,f as u,g as m,F as p,h as g,u as f,j as v,k as x,t as _,l as b,p as y,m as h,E as C,ab as k,Z as w,n as F,B as z,D as S,C as U,K as G,c as j,J as A,U as I,Q as N}from"./index-E36eYFUz.js";import{_ as D}from"./CxTabs.BRUHryh_.js";import{_ as R}from"./CxTag.DU_-stGW.js";import{_ as T}from"./CxComfirmBtn.D_Y-qTM9.js";import{o as V,e as M}from"./xn.B6pvNNd_.js";import{_ as B}from"./CxModal.B62FgOA2.js";const E=t({__name:"Completed",props:{status:{type:[Number,Array],default:70}},setup(e){a(3);const t=a([]),w=a(!1),F=a(!1),z=a(1),S=a(10),U=a(!1),G=a("loadmore"),j=e,A=async(e=!1)=>{if(e&&(z.value=1,U.value=!1,F.value=!0,t.value=[]),!U.value||e){w.value=!0,G.value="loading";try{const a={page_no:z.value,page_size:S.value};null!==j.status&&void 0!==j.status&&(a.status=j.status);const l=await V(a);if(200===l.code||0===l.code){const a=l.data.lists||[];a.length<S.value&&(U.value=!0,G.value="nomore"),e?(t.value=a,e||(G.value="loadmore")):(t.value=[...t.value,...a],G.value=U.value?"loadmore":"nomore"),z.value++,console.log("列表数据",t)}else console.error("获取订单列表失败:",l.msg)}catch(a){e||(G.value="loadmore"),console.error("数据加载失败:",a)}finally{w.value=!1,F.value=!1}}},I=()=>{F.value=!0,A(!0)},N=()=>{w.value||U.value||A()};return l((()=>{A()})),(e,a)=>{const l=y,z=h,S=s(o("CxTag"),R),G=r("up-icon"),j=C,A=s(o("CxComfirmBtn"),T),D=s(o("u-loading-icon"),n),V=s(o("u-empty"),i),M=k;return c(),d(M,{"scroll-y":!0,onRefresherrefresh:I,onScrolltolower:N,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":f(F),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:u((()=>[(c(!0),m(p,null,g(f(t),((e,t)=>(c(),d(z,{key:t,class:"order-card-item"},{default:u((()=>[v(z,{class:"card-header"},{default:u((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(z,{class:"card-content"},{default:u((()=>[v(z,{class:"card-title"},{default:u((()=>[x(_(e.name),1)])),_:2},1024),v(z,{class:"tags"},{default:u((()=>[v(S,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),x("  "),v(S,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(z,{class:"bottom-row"},{default:u((()=>[v(z,{class:"complete-time"},{default:u((()=>[v(G,{name:"clock",color:"#04427F",size:"36rpx"}),x("  "),v(j,null,{default:u((()=>[x(_(e.end_time),1)])),_:2},1024)])),_:2},1024),v(z,{class:"can-grab"},{default:u((()=>[v(A,{btnStyle:{height:"60rpx"},text:"提交成品"})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),f(w)&&!f(F)?(c(),d(D,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):b("",!0),f(t).length>0&&!f(w)&&f(U)?(c(),d(V,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):b("",!0),0!==f(t).length||f(w)||f(F)?b("",!0):(c(),d(V,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"])}}},[["__scopeId","data-v-2c45982b"]]),H=t({__name:"Unfinished",props:{status_list:{type:String,default:"10,20,30,40,50,60,80,90"}},setup(e){let t=a(!1),G=a(!1),j={};const A={10:{text:"待支付",color:"#FF4D4F"},20:{text:"待发货",color:"#FA8C16"},30:{text:"待接收材料",color:"#1890FF"},40:{text:"待发成品",color:"#FA541C"},50:{text:"待接收成品",color:"#13C2C2"},60:{text:"待验收",color:"#722ED1"},70:{text:"验收成功",color:"#52C41A"},80:{text:"验收失败",color:"#A8071A"},90:{text:"取消订单",color:"#8C8C8C"}},I=e=>{var t;return(null==(t=A[e])?void 0:t.text)||"未知状态"},N={height:"60rpx"};a(3);const D=a([]),E=a(!1),H=a(!1),L=a(1),$=a(10),q=a(!1),J=a("loadmore"),K=e,O=async(e=!1)=>{if(e&&(L.value=1,q.value=!1,H.value=!0,D.value=[]),!q.value||e){E.value=!0,J.value="loading";try{const t={page_no:L.value,page_size:$.value};null!==K.status_list&&void 0!==K.status_list&&(t.status_list=K.status_list);const a=await V(t);if(200===a.code||0===a.code){const t=a.data.lists||[];t.length<$.value&&(q.value=!0,J.value="nomore"),e?(D.value=t,e||(J.value="loadmore")):(D.value=[...D.value,...t],J.value=q.value?"loadmore":"nomore"),L.value++,console.log("列表数据",D)}else console.error("获取订单列表失败:",a.msg)}catch(t){e||(J.value="loadmore"),console.error("数据加载失败:",t)}finally{E.value=!1,H.value=!1}}},Q=()=>{H.value=!0,O(!0)},W=()=>{E.value||q.value||O()},Z=async()=>{const{msg:e,data:t,code:a}=await M({id:j.id,order_id:j.order_id,status:40});200===a?(S({title:"已确认收到材料",icon:"none"}),Q()):S({title:e||"操作失败",icon:"none"})},P=async()=>{if(!logisticsNumber.value)return void S({title:"请输入物流单号",icon:"none"});const{msg:e,data:t,code:a}=await M({id:j.id,order_id:j.order_id,status:50,finish_order_number:logisticsNumber.value});200===a?(S({title:"订单已完成",icon:"none"}),logisticsNumber.value="",Q()):S({title:e||"操作失败",icon:"none"})},X=({type:e,item:a})=>{switch(j=a,e){case"pay":U({url:`/pages-xn/my/deposit?id=${a.id}`,success:e=>{e.eventChannel.emit("sendMarginDatas",{marginResultData:a})},fail:e=>{console.error("跳转失败",e)}}),S({title:"跳转支付页面",icon:"none"});break;case"remind":(async e=>{const{msg:t,data:a,code:l}=await orderRemind({order_id:e.order_id});S(200===l?{title:"已提醒商家发货",icon:"none"}:{title:t||"操作失败",icon:"none"})})(a);break;case"logistics":S({title:"查看物流详情",icon:"none"});break;case"receivingMaterials":G.value=!0;break;case"produced":t.value=!0;break;case"detail":U({url:"/pages-xn/orders/detail",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}})}};return l((()=>{O()})),(e,a)=>{const l=y,S=h,U=s(o("CxTag"),R),j=r("up-icon"),V=C,M=s(o("CxComfirmBtn"),T),L=s(o("u-loading-icon"),n),$=s(o("u-empty"),i),J=k,K=s(o("CxModal"),B),O=s(o("u-input"),w);return c(),m(p,null,[v(J,{"scroll-y":!0,onRefresherrefresh:Q,onScrolltolower:W,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":f(H),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:u((()=>[(c(!0),m(p,null,g(f(D),((e,t)=>(c(),d(S,{key:t,class:"order-card-item",onClick:t=>X({type:"detail",item:e})},{default:u((()=>[v(S,{class:"card-header"},{default:u((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(S,{class:"card-content"},{default:u((()=>[v(S,{class:"card-title"},{default:u((()=>[x(_(e.name),1)])),_:2},1024),v(S,{class:"tags"},{default:u((()=>[v(U,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),x("  "),v(U,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(S,{class:"bottom-row"},{default:u((()=>[v(S,{class:"complete-time"},{default:u((()=>[v(j,{name:"clock",color:"#04427F",size:"36rpx"}),x("  "),v(V,null,{default:u((()=>[x(_(e.end_time),1)])),_:2},1024)])),_:2},1024),v(S,{class:"can-grab"},{default:u((()=>[10===e.status?(c(),d(S,{key:0,class:"function-btn"},{default:u((()=>[v(M,{btnStyle:N,onClick:t=>X({type:"pay",item:e}),text:"去支付"},null,8,["onClick"])])),_:2},1024)):20===e.status?(c(),d(S,{key:1,class:"function-btn"},{default:u((()=>[v(M,{btnStyle:N,onClick:t=>X({type:"remind",item:e}),text:"提醒发货"},null,8,["onClick"])])),_:2},1024)):30===e.status?(c(),m(p,{key:2},[v(S,{class:"function-btn"},{default:u((()=>[v(M,{btnStyle:N,onClick:t=>X({type:"receivingMaterials",item:e}),text:"已收材料"},null,8,["onClick"])])),_:2},1024),x("   ")],64)):40===e.status?(c(),d(S,{key:3,class:"function-btn"},{default:u((()=>[v(M,{btnStyle:N,onClick:t=>X({type:"produced",item:e}),text:"提交成品"},null,8,["onClick"])])),_:2},1024)):b("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),v(S,{class:"order-status"},{default:u((()=>{return[v(V,{style:F({color:(t=e.status,(null==(a=A[t])?void 0:a.color)||"#333")})},{default:u((()=>[x(_(I(e.status)),1)])),_:2},1032,["style"])];var t,a})),_:2},1024)])),_:2},1032,["onClick"])))),128)),f(E)&&!f(H)?(c(),d(L,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):b("",!0),f(D).length>0&&!f(E)&&f(q)?(c(),d($,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):b("",!0),0!==f(D).length||f(E)||f(H)?b("",!0):(c(),d($,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"]),v(K,{show:f(G),"onUpdate:show":a[0]||(a[0]=e=>z(G)?G.value=e:G=e),content:"确认收材料了吗？",onConfirm:Z},null,8,["show"]),v(K,{show:f(t),"onUpdate:show":a[2]||(a[2]=e=>z(t)?t.value=e:t=e),content:"确认完成了吗？",onConfirm:P},{default:u((()=>[v(S,{class:"input-wrap"},{default:u((()=>[v(S,{style:{"font-size":"28rpx",color:"#333","margin-bottom":"10rpx"}},{default:u((()=>[x("请输入物流单号,切勿填错")])),_:1}),v(O,{modelValue:e.logisticsNumber,"onUpdate:modelValue":a[1]||(a[1]=t=>e.logisticsNumber=t),placeholder:"请输入你的物流单号",border:"surround",clearable:"",customStyle:{height:"52rpx",borderRadius:"10rpx"}},null,8,["modelValue"])])),_:1})])),_:1},8,["show"])],64)}}},[["__scopeId","data-v-edb8a72d"]]),L=t({__name:"work-management",setup(t){G((e=>({36824138:r})));const{proxy:l}=A(),r=l.$safeAreaInfo.top+80+"rpx",n={Completed:E,Unfinished:H};let i=a("作品管理");a("Unfinished");let m=a(0);const p=a(0);let g=a([{name:"已完成作品",rolse:"Completed",component:E},{name:"未完成作品",rolse:"Unfinished",component:H}]);const b=j((()=>n[1==m.value?"Unfinished":"Completed"])),y=({index:e})=>{p.value=e};return(t,a)=>{const l=s(o("LayoutNavigation"),e),r=C,n=h,p=s(o("CxTabs"),D);return c(),d(n,{class:"page-wrap work-management"},{default:u((()=>[v(l,{title:f(i)},null,8,["title"]),v(n,{class:"page-content"},{default:u((()=>[v(p,{tabItems:f(g),scrollable:!1,lineHeight:"0",lineWidth:"0",itemStyle:{paddingLeft:"0rpx",paddingRight:"0rpx"},lineColor:"rgba(244, 229, 188, 1)",modelValue:f(m),"onUpdate:modelValue":a[0]||(a[0]=e=>z(m)?m.value=e:m=e),class:"work-tabs",onChangeTab:y},{tabItem:u((({item:e,index:t})=>[v(n,{class:I(["tab-item",{active:f(m)===t}]),style:F({color:"rgba(255, 255, 255, 1)"})},{default:u((()=>[v(r,{class:"tab-text"},{default:u((()=>[x(_(e.name),1)])),_:2},1024)])),_:2},1032,["class","style"])])),_:1},8,["tabItems","modelValue"]),v(n,{class:"order-list"},{default:u((()=>[v(n,{class:"order-container"},{default:u((()=>[(c(),d(N,null,[(c(),d(o(f(b))))],1024))])),_:1})])),_:1})])),_:1}),v(n)])),_:1})}}},[["__scopeId","data-v-290b09ad"]]);export{L as default};

import{_ as e}from"./Navigation.CDuvAZ9P.js";import{_ as t,r as a,d as l,C as s,D as o,a as r,aL as n,aM as i,o as d,b as u,f as c,g as m,F as p,h as f,u as g,j as v,k as _,t as b,l as x,a0 as y,p as h,m as C,A as k,aB as w,$ as F,Z as z,n as S,H as I,a1 as U,J as A,I as G,Q as N,c as j,P as T,y as V,W as D}from"./index-CRrG_siP.js";import{_ as M}from"./CxTabs.Dqr8z3ZD.js";import{_ as R}from"./CxTag.DN-aYYVj.js";import{_ as B}from"./CxComfirmBtn.BQaNQIo1.js";import{_ as L}from"./CxModal.CGllcPVB.js";const $=t({__name:"Completed",props:{status:{type:[Number,Array],default:70}},setup(e){a(3);const t=a([]),F=a(!1),z=a(!1),S=a(1),I=a(10),U=a(!1),A=a("loadmore"),G=e,N=async(e=!1)=>{if(e&&(S.value=1,U.value=!1,z.value=!0,t.value=[]),!U.value||e){F.value=!0,A.value="loading";try{const a={page_no:S.value,page_size:I.value};null!==G.status&&void 0!==G.status&&(a.status=G.status);const l=await y(a);if(200===l.code||0===l.code){const a=l.data.lists||[];a.length<I.value&&(U.value=!0,A.value="nomore"),e?(t.value=a,e||(A.value="loadmore")):(t.value=[...t.value,...a],A.value=U.value?"loadmore":"nomore"),S.value++,console.log("列表数据",t)}else console.error("获取订单列表失败:",l.msg)}catch(a){e||(A.value="loadmore"),console.error("数据加载失败:",a)}finally{F.value=!1,z.value=!1}}},j=()=>{z.value=!0,N(!0)},T=()=>{F.value||U.value||N()};return l((()=>{N()})),(e,a)=>{const l=h,y=C,S=s(o("CxTag"),R),I=r("up-icon"),A=k,G=s(o("CxComfirmBtn"),B),N=s(o("u-loading-icon"),n),V=s(o("u-empty"),i),D=w;return d(),u(D,{"scroll-y":!0,onRefresherrefresh:j,onScrolltolower:T,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":g(z),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:c((()=>[(d(!0),m(p,null,f(g(t),((e,t)=>(d(),u(y,{key:t,class:"order-card-item"},{default:c((()=>[v(y,{class:"card-header"},{default:c((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(y,{class:"card-content"},{default:c((()=>[v(y,{class:"card-title"},{default:c((()=>[_(b(e.name),1)])),_:2},1024),v(y,{class:"tags"},{default:c((()=>[v(S,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),_("  "),v(S,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(y,{class:"bottom-row"},{default:c((()=>[v(y,{class:"complete-time"},{default:c((()=>[v(I,{name:"clock",color:"#04427F",size:"36rpx"}),_("  "),v(A,null,{default:c((()=>[_(b(e.end_time),1)])),_:2},1024)])),_:2},1024),v(y,{class:"can-grab"},{default:c((()=>[v(G,{btnStyle:{height:"60rpx"},text:"提交成品"})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),g(F)&&!g(z)?(d(),u(N,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):x("",!0),g(t).length>0&&!g(F)&&g(U)?(d(),u(V,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):x("",!0),0!==g(t).length||g(F)||g(z)?x("",!0):(d(),u(V,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"])}}},[["__scopeId","data-v-a25ebc64"]]),H=t({__name:"Unfinished",props:{status_list:{type:String,default:"10,20,30,40,50,60,80,90"}},setup(e){let t=a(!1),N=a(!1),j={};const T={10:{text:"待支付",color:"#FF4D4F"},20:{text:"待发货",color:"#FA8C16"},30:{text:"待接受材料",color:"#1890FF"},40:{text:"待发成品",color:"#FA541C"},50:{text:"待接收成品",color:"#13C2C2"},60:{text:"待验收",color:"#722ED1"},70:{text:"验收成功",color:"#52C41A"},80:{text:"验收失败",color:"#A8071A"},90:{text:"取消订单",color:"#8C8C8C"}},V=e=>{var t;return(null==(t=T[e])?void 0:t.text)||"未知状态"},D={height:"60rpx"};a(3);const M=a([]),$=a(!1),H=a(!1),O=a(1),Q=a(10),W=a(!1),E=a("loadmore"),J=e,P=async(e=!1)=>{if(e&&(O.value=1,W.value=!1,H.value=!0,M.value=[]),!W.value||e){$.value=!0,E.value="loading";try{const t={page_no:O.value,page_size:Q.value};null!==J.status_list&&void 0!==J.status_list&&(t.status_list=J.status_list);const a=await y(t);if(200===a.code||0===a.code){const t=a.data.lists||[];t.length<Q.value&&(W.value=!0,E.value="nomore"),e?(M.value=t,e||(E.value="loadmore")):(M.value=[...M.value,...t],E.value=W.value?"loadmore":"nomore"),O.value++,console.log("列表数据",M)}else console.error("获取订单列表失败:",a.msg)}catch(t){e||(E.value="loadmore"),console.error("数据加载失败:",t)}finally{$.value=!1,H.value=!1}}},Z=()=>{H.value=!0,P(!0)},q=()=>{$.value||W.value||P()},K=async()=>{const{msg:e,data:t,code:a}=await U({id:j.id,order_id:j.order_id,status:40});200===a?(A({title:"已确认收到材料",icon:"none"}),Z()):A({title:e||"操作失败",icon:"none"})},X=async()=>{if(!logisticsNumber.value)return void A({title:"请输入物流单号",icon:"none"});const{msg:e,data:t,code:a}=await U({id:j.id,order_id:j.order_id,status:50,finish_order_number:logisticsNumber.value});200===a?(A({title:"订单已完成",icon:"none"}),logisticsNumber.value="",Z()):A({title:e||"操作失败",icon:"none"})},Y=({type:e,item:a})=>{switch(j=a,e){case"pay":G({url:`/pages/xn/my/deposit?id=${a.id}&order_id=${a.order_id}`}),A({title:"跳转支付页面",icon:"none"});break;case"remind":A({title:"已提醒商家发货",icon:"success"}),window.location.href="https://www.baidu.com/s?wd=773394725450239";break;case"logistics":G({url:"https://www.baidu.com/s?wd=773394725450239",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}}),A({title:"查看物流详情",icon:"none"});break;case"receivingMaterials":N.value=!0;break;case"produced":t.value=!0;break;case"detail":G({url:"/pages/xn/orders/detail",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}})}};return l((()=>{P()})),(e,a)=>{const l=h,y=C,U=s(o("CxTag"),R),A=r("up-icon"),G=k,j=s(o("CxComfirmBtn"),B),O=s(o("u-loading-icon"),n),Q=s(o("u-empty"),i),E=w,J=s(o("CxModal"),L),P=s(o("u-input"),F);return d(),m(p,null,[v(E,{"scroll-y":!0,onRefresherrefresh:Z,onScrolltolower:q,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":g(H),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:c((()=>[(d(!0),m(p,null,f(g(M),((e,t)=>(d(),u(y,{key:t,class:"order-card-item",onClick:t=>Y({type:"detail",item:e})},{default:c((()=>[v(y,{class:"card-header"},{default:c((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(y,{class:"card-content"},{default:c((()=>[v(y,{class:"card-title"},{default:c((()=>[_(b(e.name),1)])),_:2},1024),v(y,{class:"tags"},{default:c((()=>[v(U,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),_("  "),v(U,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(y,{class:"bottom-row"},{default:c((()=>[v(y,{class:"complete-time"},{default:c((()=>[v(A,{name:"clock",color:"#04427F",size:"36rpx"}),_("  "),v(G,null,{default:c((()=>[_(b(e.end_time),1)])),_:2},1024)])),_:2},1024),v(y,{class:"can-grab"},{default:c((()=>[10===e.status?(d(),u(y,{key:0,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:D,onClick:z((t=>Y({type:"pay",item:e})),["stop"]),text:"去支付"},null,8,["onClick"])])),_:2},1024)):20===e.status?(d(),u(y,{key:1,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:D,onClick:z((t=>Y({type:"remind",item:e})),["stop"]),text:"提醒发货"},null,8,["onClick"])])),_:2},1024)):30===e.status?(d(),m(p,{key:2},[v(y,{class:"function-btn"},{default:c((()=>[v(j,{btnStyle:D,onClick:z((t=>Y({type:"receivingMaterials",item:e})),["stop"]),text:"已收材料"},null,8,["onClick"])])),_:2},1024),_("   ")],64)):40===e.status?(d(),u(y,{key:3,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:D,onClick:z((t=>Y({type:"produced",item:e})),["stop"]),text:"制作完成"},null,8,["onClick"])])),_:2},1024)):x("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),v(y,{class:"order-status"},{default:c((()=>{return[v(G,{style:S({color:(t=e.status,(null==(a=T[t])?void 0:a.color)||"#333")})},{default:c((()=>[_(b(V(e.status)),1)])),_:2},1032,["style"])];var t,a})),_:2},1024)])),_:2},1032,["onClick"])))),128)),g($)&&!g(H)?(d(),u(O,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):x("",!0),g(M).length>0&&!g($)&&g(W)?(d(),u(Q,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):x("",!0),0!==g(M).length||g($)||g(H)?x("",!0):(d(),u(Q,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"]),v(J,{show:g(N),"onUpdate:show":a[0]||(a[0]=e=>I(N)?N.value=e:N=e),content:"确认收材料了吗？",onConfirm:K},null,8,["show"]),v(J,{show:g(t),"onUpdate:show":a[2]||(a[2]=e=>I(t)?t.value=e:t=e),content:"确认完成了吗？",onConfirm:X},{default:c((()=>[v(y,{class:"input-wrap"},{default:c((()=>[v(y,{style:{"font-size":"28rpx",color:"#333","margin-bottom":"10rpx"}},{default:c((()=>[_("请输入物流单号,切勿填错")])),_:1}),v(P,{modelValue:e.logisticsNumber,"onUpdate:modelValue":a[1]||(a[1]=t=>e.logisticsNumber=t),placeholder:"请输入你的物流单号",border:"surround",clearable:"",customStyle:{height:"52rpx",borderRadius:"10rpx"}},null,8,["modelValue"])])),_:1})])),_:1},8,["show"])],64)}}},[["__scopeId","data-v-725afe91"]]),O=t({__name:"work-management",setup(t){N((e=>({"413d3d7e":r})));const{proxy:l}=T(),r=l.$safeAreaInfo.top+80+"rpx",n={Completed:$,Unfinished:H};let i=a("作品管理");a("Unfinished");let m=a(0),p=a([{name:"已完成作品",rolse:"Completed"},{name:"未完成作品",rolse:"Unfinished"}]);const f=j((()=>n[1==m.value?"Unfinished":"Completed"]));return(t,a)=>{const l=s(o("LayoutNavigation"),e),r=k,n=C,x=s(o("CxTabs"),M);return d(),u(n,{class:"page-wrap work-management"},{default:c((()=>[v(l,{title:g(i)},null,8,["title"]),v(n,{class:"page-content"},{default:c((()=>[v(x,{tabItems:g(p),scrollable:!1,lineHeight:"0",lineWidth:"0",itemStyle:{paddingLeft:"0rpx",paddingRight:"0rpx"},lineColor:"rgba(244, 229, 188, 1)",modelValue:g(m),"onUpdate:modelValue":a[0]||(a[0]=e=>I(m)?m.value=e:m=e),class:"work-tabs"},{tabItem:c((({item:e,index:t})=>[v(n,{class:V(["tab-item",{active:g(m)===t}]),style:S({color:"rgba(255, 255, 255, 1)"})},{default:c((()=>[v(r,{class:"tab-text"},{default:c((()=>[_(b(e.name),1)])),_:2},1024)])),_:2},1032,["class","style"])])),_:1},8,["tabItems","modelValue"]),v(n,{class:"order-list"},{default:c((()=>[v(n,{class:"order-container"},{default:c((()=>[(d(),u(D,null,[(d(),u(o(g(f))))],1024))])),_:1})])),_:1})])),_:1}),v(n)])),_:1})}}},[["__scopeId","data-v-eda8787b"]]);export{O as default};

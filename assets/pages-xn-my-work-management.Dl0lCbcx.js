import{_ as e}from"./Navigation.CPbYaFbJ.js";import{_ as t,r as a,d as l,C as s,D as o,a as r,aM as n,aN as i,o as d,b as u,f as c,g as m,F as p,h as f,u as g,j as v,k as _,t as b,l as x,a1 as y,p as h,m as C,A as k,aC as w,a0 as F,$ as z,n as S,H as I,a2 as U,J as N,I as A,R as G,c as j,Q as M,y as R,X as T}from"./index-DiJpDbC3.js";import{_ as V}from"./CxTabs.DFR8cRTo.js";import{_ as D}from"./CxTag.DaRaAxA3.js";import{_ as $}from"./CxComfirmBtn.CPDBkoVY.js";import{_ as B}from"./CxModal.B_6smIRI.js";const H=t({__name:"Completed",props:{status:{type:[Number,Array],default:70}},setup(e){a(3);const t=a([]),F=a(!1),z=a(!1),S=a(1),I=a(10),U=a(!1),N=a("loadmore"),A=e,G=async(e=!1)=>{if(e&&(S.value=1,U.value=!1,z.value=!0,t.value=[]),!U.value||e){F.value=!0,N.value="loading";try{const a={page_no:S.value,page_size:I.value};null!==A.status&&void 0!==A.status&&(a.status=A.status);const l=await y(a);if(200===l.code||0===l.code){const a=l.data.lists||[];a.length<I.value&&(U.value=!0,N.value="nomore"),e?(t.value=a,e||(N.value="loadmore")):(t.value=[...t.value,...a],N.value=U.value?"loadmore":"nomore"),S.value++,console.log("列表数据",t)}else console.error("获取订单列表失败:",l.msg)}catch(a){e||(N.value="loadmore"),console.error("数据加载失败:",a)}finally{F.value=!1,z.value=!1}}},j=()=>{z.value=!0,G(!0)},M=()=>{F.value||U.value||G()};return l((()=>{G()})),(e,a)=>{const l=h,y=C,S=s(o("CxTag"),D),I=r("up-icon"),N=k,A=s(o("CxComfirmBtn"),$),G=s(o("u-loading-icon"),n),R=s(o("u-empty"),i),T=w;return d(),u(T,{"scroll-y":!0,onRefresherrefresh:j,onScrolltolower:M,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":g(z),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:c((()=>[(d(!0),m(p,null,f(g(t),((e,t)=>(d(),u(y,{key:t,class:"order-card-item"},{default:c((()=>[v(y,{class:"card-header"},{default:c((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(y,{class:"card-content"},{default:c((()=>[v(y,{class:"card-title"},{default:c((()=>[_(b(e.name),1)])),_:2},1024),v(y,{class:"tags"},{default:c((()=>[v(S,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),_("  "),v(S,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(y,{class:"bottom-row"},{default:c((()=>[v(y,{class:"complete-time"},{default:c((()=>[v(I,{name:"clock",color:"#04427F",size:"36rpx"}),_("  "),v(N,null,{default:c((()=>[_(b(e.end_time),1)])),_:2},1024)])),_:2},1024),v(y,{class:"can-grab"},{default:c((()=>[v(A,{btnStyle:{height:"60rpx"},text:"提交成品"})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),g(F)&&!g(z)?(d(),u(G,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):x("",!0),g(t).length>0&&!g(F)&&g(U)?(d(),u(R,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):x("",!0),0!==g(t).length||g(F)||g(z)?x("",!0):(d(),u(R,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"])}}},[["__scopeId","data-v-2c45982b"]]),L=t({__name:"Unfinished",props:{status_list:{type:String,default:"10,20,30,40,50,60,80,90"}},setup(e){let t=a(!1),G=a(!1),j={};const M={10:{text:"待支付",color:"#FF4D4F"},20:{text:"待发货",color:"#FA8C16"},30:{text:"待接受材料",color:"#1890FF"},40:{text:"待发成品",color:"#FA541C"},50:{text:"待接收成品",color:"#13C2C2"},60:{text:"待验收",color:"#722ED1"},70:{text:"验收成功",color:"#52C41A"},80:{text:"验收失败",color:"#A8071A"},90:{text:"取消订单",color:"#8C8C8C"}},R=e=>{var t;return(null==(t=M[e])?void 0:t.text)||"未知状态"},T={height:"60rpx"};a(3);const V=a([]),H=a(!1),L=a(!1),O=a(1),E=a(10),J=a(!1),Q=a("loadmore"),W=e,X=async(e=!1)=>{if(e&&(O.value=1,J.value=!1,L.value=!0,V.value=[]),!J.value||e){H.value=!0,Q.value="loading";try{const t={page_no:O.value,page_size:E.value};null!==W.status_list&&void 0!==W.status_list&&(t.status_list=W.status_list);const a=await y(t);if(200===a.code||0===a.code){const t=a.data.lists||[];t.length<E.value&&(J.value=!0,Q.value="nomore"),e?(V.value=t,e||(Q.value="loadmore")):(V.value=[...V.value,...t],Q.value=J.value?"loadmore":"nomore"),O.value++,console.log("列表数据",V)}else console.error("获取订单列表失败:",a.msg)}catch(t){e||(Q.value="loadmore"),console.error("数据加载失败:",t)}finally{H.value=!1,L.value=!1}}},q=()=>{L.value=!0,X(!0)},K=()=>{H.value||J.value||X()},P=async()=>{const{msg:e,data:t,code:a}=await U({id:j.id,order_id:j.order_id,status:40});200===a?(N({title:"已确认收到材料",icon:"none"}),q()):N({title:e||"操作失败",icon:"none"})},Y=async()=>{if(!logisticsNumber.value)return void N({title:"请输入物流单号",icon:"none"});const{msg:e,data:t,code:a}=await U({id:j.id,order_id:j.order_id,status:50,finish_order_number:logisticsNumber.value});200===a?(N({title:"订单已完成",icon:"none"}),logisticsNumber.value="",q()):N({title:e||"操作失败",icon:"none"})},Z=({type:e,item:a})=>{switch(j=a,e){case"pay":A({url:`/pages/xn/my/deposit?id=${a.id}&order_id=${a.order_id}`}),N({title:"跳转支付页面",icon:"none"});break;case"remind":N({title:"已提醒商家发货",icon:"success"}),window.location.href="https://www.baidu.com/s?wd=773394725450239";break;case"logistics":A({url:"https://www.baidu.com/s?wd=773394725450239",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}}),N({title:"查看物流详情",icon:"none"});break;case"receivingMaterials":G.value=!0;break;case"produced":t.value=!0;break;case"detail":A({url:"/pages/xn/orders/detail",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}})}};return l((()=>{X()})),(e,a)=>{const l=h,y=C,U=s(o("CxTag"),D),N=r("up-icon"),A=k,j=s(o("CxComfirmBtn"),$),O=s(o("u-loading-icon"),n),E=s(o("u-empty"),i),Q=w,W=s(o("CxModal"),B),X=s(o("u-input"),F);return d(),m(p,null,[v(Q,{"scroll-y":!0,onRefresherrefresh:q,onScrolltolower:K,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":g(L),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:c((()=>[(d(!0),m(p,null,f(g(V),((e,t)=>(d(),u(y,{key:t,class:"order-card-item",onClick:t=>Z({type:"detail",item:e})},{default:c((()=>[v(y,{class:"card-header"},{default:c((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(y,{class:"card-content"},{default:c((()=>[v(y,{class:"card-title"},{default:c((()=>[_(b(e.name),1)])),_:2},1024),v(y,{class:"tags"},{default:c((()=>[v(U,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),_("  "),v(U,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(y,{class:"bottom-row"},{default:c((()=>[v(y,{class:"complete-time"},{default:c((()=>[v(N,{name:"clock",color:"#04427F",size:"36rpx"}),_("  "),v(A,null,{default:c((()=>[_(b(e.end_time),1)])),_:2},1024)])),_:2},1024),v(y,{class:"can-grab"},{default:c((()=>[10===e.status?(d(),u(y,{key:0,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:T,onClick:z((t=>Z({type:"pay",item:e})),["stop"]),text:"去支付"},null,8,["onClick"])])),_:2},1024)):20===e.status?(d(),u(y,{key:1,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:T,onClick:z((t=>Z({type:"remind",item:e})),["stop"]),text:"提醒发货"},null,8,["onClick"])])),_:2},1024)):30===e.status?(d(),m(p,{key:2},[v(y,{class:"function-btn"},{default:c((()=>[v(j,{btnStyle:T,onClick:z((t=>Z({type:"receivingMaterials",item:e})),["stop"]),text:"已收材料"},null,8,["onClick"])])),_:2},1024),_("   ")],64)):40===e.status?(d(),u(y,{key:3,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:T,onClick:z((t=>Z({type:"produced",item:e})),["stop"]),text:"制作完成"},null,8,["onClick"])])),_:2},1024)):x("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),v(y,{class:"order-status"},{default:c((()=>{return[v(A,{style:S({color:(t=e.status,(null==(a=M[t])?void 0:a.color)||"#333")})},{default:c((()=>[_(b(R(e.status)),1)])),_:2},1032,["style"])];var t,a})),_:2},1024)])),_:2},1032,["onClick"])))),128)),g(H)&&!g(L)?(d(),u(O,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):x("",!0),g(V).length>0&&!g(H)&&g(J)?(d(),u(E,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):x("",!0),0!==g(V).length||g(H)||g(L)?x("",!0):(d(),u(E,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"]),v(W,{show:g(G),"onUpdate:show":a[0]||(a[0]=e=>I(G)?G.value=e:G=e),content:"确认收材料了吗？",onConfirm:P},null,8,["show"]),v(W,{show:g(t),"onUpdate:show":a[2]||(a[2]=e=>I(t)?t.value=e:t=e),content:"确认完成了吗？",onConfirm:Y},{default:c((()=>[v(y,{class:"input-wrap"},{default:c((()=>[v(y,{style:{"font-size":"28rpx",color:"#333","margin-bottom":"10rpx"}},{default:c((()=>[_("请输入物流单号,切勿填错")])),_:1}),v(X,{modelValue:e.logisticsNumber,"onUpdate:modelValue":a[1]||(a[1]=t=>e.logisticsNumber=t),placeholder:"请输入你的物流单号",border:"surround",clearable:"",customStyle:{height:"52rpx",borderRadius:"10rpx"}},null,8,["modelValue"])])),_:1})])),_:1},8,["show"])],64)}}},[["__scopeId","data-v-2d7e47b3"]]),O=t({__name:"work-management",setup(t){G((e=>({"413d3d7e":r})));const{proxy:l}=M(),r=l.$safeAreaInfo.top+80+"rpx",n={Completed:H,Unfinished:L};let i=a("作品管理");a("Unfinished");let m=a(0),p=a([{name:"已完成作品",rolse:"Completed"},{name:"未完成作品",rolse:"Unfinished"}]);const f=j((()=>n[1==m.value?"Unfinished":"Completed"]));return(t,a)=>{const l=s(o("LayoutNavigation"),e),r=k,n=C,x=s(o("CxTabs"),V);return d(),u(n,{class:"page-wrap work-management"},{default:c((()=>[v(l,{title:g(i)},null,8,["title"]),v(n,{class:"page-content"},{default:c((()=>[v(x,{tabItems:g(p),scrollable:!1,lineHeight:"0",lineWidth:"0",itemStyle:{paddingLeft:"0rpx",paddingRight:"0rpx"},lineColor:"rgba(244, 229, 188, 1)",modelValue:g(m),"onUpdate:modelValue":a[0]||(a[0]=e=>I(m)?m.value=e:m=e),class:"work-tabs"},{tabItem:c((({item:e,index:t})=>[v(n,{class:R(["tab-item",{active:g(m)===t}]),style:S({color:"rgba(255, 255, 255, 1)"})},{default:c((()=>[v(r,{class:"tab-text"},{default:c((()=>[_(b(e.name),1)])),_:2},1024)])),_:2},1032,["class","style"])])),_:1},8,["tabItems","modelValue"]),v(n,{class:"order-list"},{default:c((()=>[v(n,{class:"order-container"},{default:c((()=>[(d(),u(T,null,[(d(),u(o(g(f))))],1024))])),_:1})])),_:1})])),_:1}),v(n)])),_:1})}}},[["__scopeId","data-v-eda8787b"]]);export{O as default};

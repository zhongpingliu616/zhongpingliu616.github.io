import{_ as e}from"./Navigation.DvAH-mKo.js";import{_ as t,r as a,d as l,C as s,D as o,a as r,aI as n,aJ as i,o as d,b as u,f as c,g as m,F as p,h as f,u as g,j as v,k as _,t as b,l as x,a0 as y,p as h,m as C,A as k,aH as w,$ as F,Z as z,n as I,H as S,a1 as U,J as A,I as G,Q as N,c as j,P as V,y as D,W as R}from"./index-bLIxdInw.js";import{_ as T}from"./CxTabs.BM4yjAV1.js";import{_ as M}from"./CxTag.Ubg2F8Fn.js";import{_ as $}from"./CxComfirmBtn.BhasumNO.js";import{_ as B}from"./CxModal.BSOB5gcq.js";const H=t({__name:"Completed",props:{status:{type:[Number,Array],default:70}},setup(e){a(3);const t=a([]),F=a(!1),z=a(!1),I=a(1),S=a(10),U=a(!1),A=a("loadmore"),G=e,N=async(e=!1)=>{if(e&&(I.value=1,U.value=!1,z.value=!0,t.value=[]),!U.value||e){F.value=!0,A.value="loading";try{const a={page_no:I.value,page_size:S.value};null!==G.status&&void 0!==G.status&&(a.status=G.status);const l=await y(a);if(200===l.code||0===l.code){const a=l.data.lists||[];a.length<S.value&&(U.value=!0,A.value="nomore"),e?(t.value=a,e||(A.value="loadmore")):(t.value=[...t.value,...a],A.value=U.value?"loadmore":"nomore"),I.value++,console.log("列表数据",t)}else console.error("获取订单列表失败:",l.msg)}catch(a){e||(A.value="loadmore"),console.error("数据加载失败:",a)}finally{F.value=!1,z.value=!1}}},j=()=>{z.value=!0,N(!0)},V=()=>{F.value||U.value||N()};return l((()=>{N()})),(e,a)=>{const l=h,y=C,I=s(o("CxTag"),M),S=r("up-icon"),A=k,G=s(o("CxComfirmBtn"),$),N=s(o("u-loading-icon"),n),D=s(o("u-empty"),i),R=w;return d(),u(R,{"scroll-y":!0,onRefresherrefresh:j,onScrolltolower:V,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":g(z),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:c((()=>[(d(!0),m(p,null,f(g(t),((e,t)=>(d(),u(y,{key:t,class:"order-card-item"},{default:c((()=>[v(y,{class:"card-header"},{default:c((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(y,{class:"card-content"},{default:c((()=>[v(y,{class:"card-title"},{default:c((()=>[_(b(e.name),1)])),_:2},1024),v(y,{class:"tags"},{default:c((()=>[v(I,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),_("  "),v(I,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(y,{class:"bottom-row"},{default:c((()=>[v(y,{class:"complete-time"},{default:c((()=>[v(S,{name:"clock",color:"#04427F",size:"36rpx"}),_("  "),v(A,null,{default:c((()=>[_(b(e.end_time),1)])),_:2},1024)])),_:2},1024),v(y,{class:"can-grab"},{default:c((()=>[v(G,{btnStyle:{height:"60rpx"},text:"提交成品"})])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),g(F)&&!g(z)?(d(),u(N,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):x("",!0),g(t).length>0&&!g(F)&&g(U)?(d(),u(D,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):x("",!0),0!==g(t).length||g(F)||g(z)?x("",!0):(d(),u(D,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"])}}},[["__scopeId","data-v-a25ebc64"]]),J=t({__name:"Unfinished",props:{status_list:{type:String,default:"10,20,30,40,50,60,80,90"}},setup(e){let t=a(!1),N=a(!1),j={};const V={10:{text:"待支付",color:"#FF4D4F"},20:{text:"待发货",color:"#FA8C16"},30:{text:"待接受材料",color:"#1890FF"},40:{text:"待发成品",color:"#FA541C"},50:{text:"待接收成品",color:"#13C2C2"},60:{text:"待验收",color:"#722ED1"},70:{text:"验收成功",color:"#52C41A"},80:{text:"验收失败",color:"#A8071A"},90:{text:"取消订单",color:"#8C8C8C"}},D=e=>{var t;return(null==(t=V[e])?void 0:t.text)||"未知状态"},R={height:"60rpx"};a(3);const T=a([]),H=a(!1),J=a(!1),L=a(1),O=a(10),P=a(!1),Q=a("loadmore"),W=e,E=async(e=!1)=>{if(e&&(L.value=1,P.value=!1,J.value=!0,T.value=[]),!P.value||e){H.value=!0,Q.value="loading";try{const t={page_no:L.value,page_size:O.value};null!==W.status_list&&void 0!==W.status_list&&(t.status_list=W.status_list);const a=await y(t);if(200===a.code||0===a.code){const t=a.data.lists||[];t.length<O.value&&(P.value=!0,Q.value="nomore"),e?(T.value=t,e||(Q.value="loadmore")):(T.value=[...T.value,...t],Q.value=P.value?"loadmore":"nomore"),L.value++,console.log("列表数据",T)}else console.error("获取订单列表失败:",a.msg)}catch(t){e||(Q.value="loadmore"),console.error("数据加载失败:",t)}finally{H.value=!1,J.value=!1}}},K=()=>{J.value=!0,E(!0)},Z=()=>{H.value||P.value||E()},q=async()=>{const{msg:e,data:t,code:a}=await U({id:j.id,order_id:j.order_id,status:40});200===a?(A({title:"已确认收到材料",icon:"none"}),K()):A({title:e||"操作失败",icon:"none"})},X=async()=>{if(!logisticsNumber.value)return void A({title:"请输入物流单号",icon:"none"});const{msg:e,data:t,code:a}=await U({id:j.id,order_id:j.order_id,status:50,finish_order_number:logisticsNumber.value});200===a?(A({title:"订单已完成",icon:"none"}),logisticsNumber.value="",K()):A({title:e||"操作失败",icon:"none"})},Y=({type:e,item:a})=>{switch(j=a,e){case"pay":G({url:`/pages/xn/my/deposit?id=${a.id}&order_id=${a.order_id}`}),A({title:"跳转支付页面",icon:"none"});break;case"remind":A({title:"已提醒商家发货",icon:"success"}),window.location.href="https://www.baidu.com/s?wd=773394725450239";break;case"logistics":G({url:"https://www.baidu.com/s?wd=773394725450239",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}}),A({title:"查看物流详情",icon:"none"});break;case"receivingMaterials":N.value=!0;break;case"produced":t.value=!0;break;case"detail":G({url:"/pages/xn/orders/detail",success:e=>{e.eventChannel.emit("sendOrderDatas",{orderInfo:j})}})}};return l((()=>{E()})),(e,a)=>{const l=h,y=C,U=s(o("CxTag"),M),A=r("up-icon"),G=k,j=s(o("CxComfirmBtn"),$),L=s(o("u-loading-icon"),n),O=s(o("u-empty"),i),Q=w,W=s(o("CxModal"),B),E=s(o("u-input"),F);return d(),m(p,null,[v(Q,{"scroll-y":!0,onRefresherrefresh:K,onScrolltolower:Z,"enable-back-to-top":!0,"refresher-enabled":!0,"refresher-triggered":g(J),"refresher-default-style":"black","refresher-background":"transparent","lower-threshold":100,class:"scroll-view"},{default:c((()=>[(d(!0),m(p,null,f(g(T),((e,t)=>(d(),u(y,{key:t,class:"order-card-item",onClick:t=>Y({type:"detail",item:e})},{default:c((()=>[v(y,{class:"card-header"},{default:c((()=>[v(l,{src:e.image,class:"card-image",mode:"aspectFill"},null,8,["src"]),v(y,{class:"card-content"},{default:c((()=>[v(y,{class:"card-title"},{default:c((()=>[_(b(e.name),1)])),_:2},1024),v(y,{class:"tags"},{default:c((()=>[v(U,{text:e.period,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"]),_("  "),v(U,{text:e.difficulty,bgGradient:["rgba(248,163,29,0.1)","rgba(248,163,29,0.1)"]},null,8,["text","bgGradient"])])),_:2},1024),v(y,{class:"bottom-row"},{default:c((()=>[v(y,{class:"complete-time"},{default:c((()=>[v(A,{name:"clock",color:"#04427F",size:"36rpx"}),_("  "),v(G,null,{default:c((()=>[_(b(e.end_time),1)])),_:2},1024)])),_:2},1024),v(y,{class:"can-grab"},{default:c((()=>[10===e.status?(d(),u(y,{key:0,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:R,onClick:z((t=>Y({type:"pay",item:e})),["stop"]),text:"去支付"},null,8,["onClick"])])),_:2},1024)):20===e.status?(d(),u(y,{key:1,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:R,onClick:z((t=>Y({type:"remind",item:e})),["stop"]),text:"提醒发货"},null,8,["onClick"])])),_:2},1024)):30===e.status?(d(),m(p,{key:2},[v(y,{class:"function-btn"},{default:c((()=>[v(j,{btnStyle:R,onClick:z((t=>Y({type:"receivingMaterials",item:e})),["stop"]),text:"已收材料"},null,8,["onClick"])])),_:2},1024),_("   ")],64)):40===e.status?(d(),u(y,{key:3,class:"function-btn"},{default:c((()=>[v(j,{btnStyle:R,onClick:z((t=>Y({type:"produced",item:e})),["stop"]),text:"制作完成"},null,8,["onClick"])])),_:2},1024)):x("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),v(y,{class:"order-status"},{default:c((()=>{return[v(G,{style:I({color:(t=e.status,(null==(a=V[t])?void 0:a.color)||"#333")})},{default:c((()=>[_(b(D(e.status)),1)])),_:2},1032,["style"])];var t,a})),_:2},1024)])),_:2},1032,["onClick"])))),128)),g(H)&&!g(J)?(d(),u(L,{key:0,"icon-size":"30rpx","show-text":!0,text:"加载中...",style:{margin:"30rpx auto"}})):x("",!0),g(T).length>0&&!g(H)&&g(P)?(d(),u(O,{key:1,mode:"data",text:"没有更多数据了","icon-size":"30rpx",style:{"margin-top":"50rpx"}})):x("",!0),0!==g(T).length||g(H)||g(J)?x("",!0):(d(),u(O,{key:2,mode:"data",text:"暂无数据","icon-size":"30rpx",style:{"margin-top":"100rpx"}}))])),_:1},8,["refresher-triggered"]),v(W,{show:g(N),"onUpdate:show":a[0]||(a[0]=e=>S(N)?N.value=e:N=e),content:"确认收材料了吗？",onConfirm:q},null,8,["show"]),v(W,{show:g(t),"onUpdate:show":a[2]||(a[2]=e=>S(t)?t.value=e:t=e),content:"确认完成了吗？",onConfirm:X},{default:c((()=>[v(y,{class:"input-wrap"},{default:c((()=>[v(y,{style:{"font-size":"28rpx",color:"#333","margin-bottom":"10rpx"}},{default:c((()=>[_("请输入物流单号,切勿填错")])),_:1}),v(E,{modelValue:e.logisticsNumber,"onUpdate:modelValue":a[1]||(a[1]=t=>e.logisticsNumber=t),placeholder:"请输入你的物流单号",border:"surround",clearable:"",customStyle:{height:"52rpx",borderRadius:"10rpx"}},null,8,["modelValue"])])),_:1})])),_:1},8,["show"])],64)}}},[["__scopeId","data-v-725afe91"]]),L=t({__name:"work-management",setup(t){N((e=>({"413d3d7e":r})));const{proxy:l}=V(),r=l.$safeAreaInfo.top+80+"rpx",n={Completed:H,Unfinished:J};let i=a("作品管理");a("Unfinished");let m=a(0),p=a([{name:"已完成作品",rolse:"Completed"},{name:"未完成作品",rolse:"Unfinished"}]);const f=j((()=>n[1==m.value?"Unfinished":"Completed"]));return(t,a)=>{const l=s(o("LayoutNavigation"),e),r=k,n=C,x=s(o("CxTabs"),T);return d(),u(n,{class:"page-wrap work-management"},{default:c((()=>[v(l,{title:g(i)},null,8,["title"]),v(n,{class:"page-content"},{default:c((()=>[v(x,{tabItems:g(p),scrollable:!1,lineHeight:"0",lineWidth:"0",itemStyle:{paddingLeft:"0rpx",paddingRight:"0rpx"},lineColor:"rgba(244, 229, 188, 1)",modelValue:g(m),"onUpdate:modelValue":a[0]||(a[0]=e=>S(m)?m.value=e:m=e),class:"work-tabs"},{tabItem:c((({item:e,index:t})=>[v(n,{class:D(["tab-item",{active:g(m)===t}]),style:I({color:"rgba(255, 255, 255, 1)"})},{default:c((()=>[v(r,{class:"tab-text"},{default:c((()=>[_(b(e.name),1)])),_:2},1024)])),_:2},1032,["class","style"])])),_:1},8,["tabItems","modelValue"]),v(n,{class:"order-list"},{default:c((()=>[v(n,{class:"order-container"},{default:c((()=>[(d(),u(R,null,[(d(),u(o(g(f))))],1024))])),_:1})])),_:1})])),_:1}),v(n)])),_:1})}}},[["__scopeId","data-v-eda8787b"]]);export{L as default};

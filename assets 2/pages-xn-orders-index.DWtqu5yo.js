import{_ as a,r as e,d as l,w as o,W as s,v as r,a as t,C as n,D as u,b as c,f as d,M as i,N as m,J as p,m as v,o as f,j as _,k as g,u as h,H as C,g as x,h as b,F as w,A as y,I as j}from"./index-Cklw5-2D.js";import{_ as T}from"./OrderCard.CAgmtGhl.js";import{_ as O}from"./ProductList.BFm6DCiw.js";import{_ as I}from"./CustomBarXn.dKELcHvV.js";import"./CxTag.b7zN5PMZ.js";import"./CxComfirmBtn.C_6MRR7B.js";const L=a({__name:"index",setup(a){e("orders");let L=e("");const S=function(a,e=1500){let l=null;const o=()=>{l&&clearTimeout(l),l=setTimeout(a,e)};return o.cancel=()=>{l&&(clearTimeout(l),l=null)},o}((()=>{A(!0)}),1600);e(3);const k=e([]),B=e(!1),R=e(!1),F=e(1),H=e(10),P=e(!1),V=e("loadmore"),X=e("flower"),A=async(a=!1)=>{if((!B.value||a)&&(!R.value||a)&&(!P.value||a)){a?(F.value=1,P.value=!1,R.value=!0,V.value="loading"):(B.value=!0,V.value="loading");try{const e=await i({page_no:F.value,page_size:H.value,keyword:L.value}),l=200===e.code&&e.data.lists||[];l.length<H.value?(P.value=!0,V.value="nomore"):V.value="loadmore",a?(k.value=l,m()):k.value=[...k.value,...l],F.value++}catch(e){V.value="loadmore",console.error("数据加载失败:",e),p({title:"加载失败",icon:"none"})}finally{B.value=!1,R.value=!1}}},G=()=>{R.value||A(!0)},J=()=>{B.value||P.value||A()},M=a=>{j({url:`/pages/xn/collection-detail/index?id=${a.id}`})},$=a=>{console.log(a),a.canGrab,j({url:`/pages/xn/my/deposit?id=${a.id}`})};l((()=>{A(!0)})),o(L,(a=>{S()}));const z=()=>{S()};return s((()=>{S&&S.cancel&&S.cancel()})),r((()=>{})),(a,e)=>{const l=v,o=y,s=t("up-col"),r=t("up-search"),i=t("up-row"),m=n(u("XnOrdersOrderCard"),T),p=n(u("BaseProductList"),O),j=n(u("LayoutCustomBarXn"),I);return f(),c(l,{class:"page-wrap orders"},{default:d((()=>[_(l),_(l,{class:"page-content"},{default:d((()=>[_(l,{class:"order-search"},{default:d((()=>[_(i,{customStyle:"margin-bottom: 10px"},{default:d((()=>[_(s,{span:"2"},{default:d((()=>[_(l,{class:"order-text-wrap"},{default:d((()=>[_(o,{class:"order-text"},{default:d((()=>[g("订单")])),_:1})])),_:1})])),_:1}),_(s,{span:"9"},{default:d((()=>[_(l,{class:"search-bar"},{default:d((()=>[_(r,{modelValue:h(L),"onUpdate:modelValue":e[0]||(e[0]=a=>C(L)?L.value=a:L=a),placeholder:"输入搜索内容",bgColor:"#fff",placeholderColor:"#AC9394",searchIconColor:"#672227",borderColor:"#FFE185",height:"66rpx",onSearch:z,"show-action":!1,clearabled:""},null,8,["modelValue"])])),_:1})])),_:1}),_(s,{span:"1"})])),_:1})])),_:1}),_(l,{class:"order-list"},{default:d((()=>[_(l,{class:"order-container"},{default:d((()=>[_(p,{onOnScrollToLower:J,onOnRefresh:G,isRefreshing:h(R),loadStatus:h(V),iconType:h(X),enableRefresh:!0,enableLoadMore:!0,class:"scroll-view"},{scrollContain:d((()=>[(f(!0),x(w,null,b(h(k),((a,e)=>(f(),c(m,{item:a,onGrabOrderClick:$,onHandleItemClick:M},null,8,["item"])))),256))])),_:1},8,["isRefreshing","loadStatus","iconType"])])),_:1})])),_:1})])),_:1}),_(j)])),_:1})}}},[["__scopeId","data-v-a9414ec1"]]);export{L as default};

import{_ as e,r as o,ad as a,C as t,D as s,b as l,f as n,Y as r,at as c,m as i,E as d,o as p,j as u,u as m,l as f,n as x,k as h,t as g,au as w,J as y,T as v,av as _,p as z,A as N}from"./index-Cklw5-2D.js";import{_ as V}from"./Navigation.DJK0J8h_.js";import{_ as P}from"./CxComfirmBtn.C_6MRR7B.js";import{_ as k}from"./zhanghao.BgAr4qWD.js";import{_ as b,a as C}from"./emiyanzhengma.C1RAKEWA.js";import{_ as j}from"./mima.CnEZst9Z.js";const F=e({__name:"regist",setup(e){let F=o("注册用户"),U=o(!1);const A=a({accoutName:"",phone:"",code:"",password:"",confirmPassword:""}),Z=a({accoutName:"",phone:"",code:"",password:"",confirmPassword:""}),$=e=>{Z[e]="",U.value=!1},I=async()=>{if((()=>{var e;let o=!0;const a=null==(e=A.accoutName)?void 0:e.trim();a?a.length<6||a.length>20?(Z.accoutName="账户名字母开头6-20位",o=!1):/^[a-zA-Z][a-zA-Z0-9]*$/.test(a)||(Z.accoutName="字母开头且仅包含字母数字",o=!1):(Z.accoutName="用户名不能为空",o=!1),A.phone?/^1[3-9]\d{9}$/.test(A.phone)||(Z.phone="手机号格式不正确",o=!1):(Z.phone="手机号不能为空",o=!1),A.code?6!==A.code.length&&(Z.code="验证码格式不正确",o=!1):(Z.code="验证码不能为空",o=!1);const t=A.password;return t?t.length<6||t.length>20?(Z.password="密码长度6-20位",o=!1):/^[A-Za-z]/.test(t)||(Z.password="密码必须字母开头",o=!1):(Z.password="密码不能为空",o=!1),A.confirmPassword?A.confirmPassword!==t&&(Z.confirmPassword="两次输入的密码不一致",o=!1):(Z.confirmPassword="请再次输入密码",o=!1),o})()){U.value=!0;try{const e=await w({username:A.accoutName,password:A.password,phone:A.phone,sms_code:A.code,confirm_password:A.confirmPassword});200===e.code?(y({title:"注册成功！",icon:"success"}),setTimeout((()=>{v({url:"/pages/login?role=XN"})}),1500)):y({title:e.msg||"注册失败",icon:"none"})}catch(e){console.error("注册失败",e),y({title:e.msg||"注册失败",icon:"none"})}finally{U.value=!1}}},B=o(!1),T=o(!1),X=o(!1),Y=o(60),D=async()=>{if(!X.value)if(A.phone)if(/^1[3-9]\d{9}$/.test(A.phone))try{const e=await _({phone:A.phone,type:1});if(200===e.code){y({title:"验证码已发送",icon:"success"}),X.value=!0;const e=setInterval((()=>{Y.value--,Y.value<=0&&(clearInterval(e),X.value=!1,Y.value=60)}),1e3)}else y({title:e.msg||"发送失败",icon:"none"})}catch(e){console.error("发送验证码失败",e),y({title:e.msg||"发送失败",icon:"none"})}else Z.phone="请输入正确的手机号";else Z.phone="请输入手机号"},E=()=>{B.value=!B.value},J=()=>{T.value=!T.value};return(e,o)=>{const a=t(s("LayoutNavigation"),V),w=z,y=t(s("u-input"),r),v=t(s("u-text"),c),_=i,L=N,Q=t(s("u-icon"),d),R=t(s("CxComfirmBtn"),P);return p(),l(_,{class:"page-wrap index"},{default:n((()=>[u(a,{title:m(F)},null,8,["title"]),u(_,{class:"page-content"},{default:n((()=>[u(_,{class:"container"},{default:n((()=>[u(_,{class:"input-item"},{default:n((()=>[u(w,{class:"input-icon",src:k,mode:"aspectFit"}),u(y,{modelValue:m(A).accoutName,"onUpdate:modelValue":[o[0]||(o[0]=e=>m(A).accoutName=e),o[1]||(o[1]=e=>$("accoutName"))],placeholder:"账户名字母开头6-20非中文字符",type:"text",border:"none",maxlength:"11","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue"]),m(Z).accoutName?(p(),l(v,{key:0,class:"error-text",text:m(Z).accoutName,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):f("",!0)])),_:1}),u(_,{class:"input-item"},{default:n((()=>[u(w,{class:"input-icon",src:b,mode:"aspectFit"}),u(y,{modelValue:m(A).phone,"onUpdate:modelValue":[o[2]||(o[2]=e=>m(A).phone=e),o[3]||(o[3]=e=>$("phone"))],placeholder:"请输入您的手机号码",type:"number",border:"none",maxlength:"11","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue"]),m(Z).phone?(p(),l(v,{key:0,class:"error-text",text:m(Z).phone,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):f("",!0)])),_:1}),u(_,{class:"input-item"},{default:n((()=>[u(w,{class:"input-icon",src:C,mode:"aspectFit"}),u(y,{modelValue:m(A).code,"onUpdate:modelValue":[o[4]||(o[4]=e=>m(A).code=e),o[5]||(o[5]=e=>$("code"))],placeholder:"请输入验证码",type:"text",border:"none","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue"]),m(Z).code?f("",!0):(p(),l(L,{key:0,onClick:D,class:"verify-btn",style:x({color:m(X)?"#ccc":"#ff4d4d",fontWeight:"normal"})},{default:n((()=>[h(g(m(X)?`${m(Y)}s后重试`:"获取验证码"),1)])),_:1},8,["style"])),m(Z).code?(p(),l(v,{key:1,class:"error-text",text:m(Z).code,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):f("",!0)])),_:1}),u(_,{class:"input-item"},{default:n((()=>[u(w,{class:"input-icon",src:j,mode:"aspectFit"}),u(y,{modelValue:m(A).password,"onUpdate:modelValue":[o[6]||(o[6]=e=>m(A).password=e),o[7]||(o[7]=e=>$("password"))],placeholder:"字母开头,必须包含特殊字符6-20位",type:m(B)?"text":"password",border:"none","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue","type"]),u(Q,{name:m(B)?"eye":"",size:"36",color:"#999",onClick:E},null,8,["name"]),m(Z).password?(p(),l(v,{key:0,class:"error-text",text:m(Z).password,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):f("",!0)])),_:1}),u(_,{class:"input-item"},{default:n((()=>[u(w,{class:"input-icon",src:j,mode:"aspectFit"}),u(y,{modelValue:m(A).confirmPassword,"onUpdate:modelValue":[o[8]||(o[8]=e=>m(A).confirmPassword=e),o[9]||(o[9]=e=>$("confirmPassword"))],placeholder:"请再次输入密码",type:m(T)?"text":"password",border:"none","input-align":"left","placeholder-style":"color: #999; font-size: 24rpx;"},null,8,["modelValue","type"]),u(Q,{name:m(T)?"eye":"",size:"36",color:"#999",onClick:J},null,8,["name"]),m(Z).confirmPassword?(p(),l(v,{key:0,class:"error-text",text:m(Z).confirmPassword,color:"#ff4d4d",size:"20",margin:"0 0 0rpx 90rpx"},null,8,["text"])):f("",!0)])),_:1})])),_:1}),u(_,{class:"regist-btn-wrap"},{default:n((()=>[u(R,{text:"确认注册",loading:m(U),onClick:I},null,8,["loading"])])),_:1})])),_:1}),u(_)])),_:1})}}},[["__scopeId","data-v-6fe89171"]]);export{F as default};
